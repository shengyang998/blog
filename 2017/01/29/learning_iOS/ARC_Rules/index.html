<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ARC Rules | Tech. Design. Life.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="A note for book Pro Multithreading and Memory Management for iOS and OS XARC is summarized in Apple’s own words:

ARC in Objective-C makes memory management the job of the compiler. By enabling ARC wi">
<meta property="og:type" content="article">
<meta property="og:title" content="ARC Rules">
<meta property="og:url" content="http://blog.superyoung.win/2017/01/29/learning_iOS/ARC_Rules/index.html">
<meta property="og:site_name" content="Tech. Design. Life.">
<meta property="og:description" content="A note for book Pro Multithreading and Memory Management for iOS and OS XARC is summarized in Apple’s own words:

ARC in Objective-C makes memory management the job of the compiler. By enabling ARC wi">
<meta property="og:updated_time" content="2017-01-29T03:30:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ARC Rules">
<meta name="twitter:description" content="A note for book Pro Multithreading and Memory Management for iOS and OS XARC is summarized in Apple’s own words:

ARC in Objective-C makes memory management the job of the compiler. By enabling ARC wi">
  
    <link rel="alternate" href="/atom.xml" title="Tech. Design. Life." type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tech. Design. Life.</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.superyoung.win"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-learning_iOS/ARC_Rules" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/29/learning_iOS/ARC_Rules/" class="article-date">
  <time datetime="2017-01-29T02:19:41.000Z" itemprop="datePublished">2017-01-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ARC Rules
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>A note for book <a href="http://www.apress.com/us/book/9781430241164" target="_blank" rel="external">Pro Multithreading and Memory Management for iOS and OS X</a><br>ARC is summarized in Apple’s own words:</p>
<blockquote>
<p>ARC in Objective-C makes memory management the job of the compiler. By enabling ARC with the new Apple LLVM compiler, you will never need to type retain or release again, dramatically simplifying the development process, while reducing craches and memory leaks. The compiler has a complete understanding of your objects, and releases each object the instant it is no longer used, so apps run as fast as ever, with predictable, smooth performance. </p>
</blockquote>
<a id="more"></a>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Actually, reference counting is still used as the basis of ARC. But ARC helps the reference counting mechanism work automatically when you follow its rules.</p>
<h2 id="The-rules-of-Reference-Counting"><a href="#The-rules-of-Reference-Counting" class="headerlink" title="The rules of Reference Counting"></a>The rules of Reference Counting</h2><ul>
<li>You have ownership of any objects you create.</li>
<li>You can take ownership of an object using retain.</li>
<li>When you no longer need it, you must relinquish ownership of an object of which you have ownership.</li>
<li>You must not relinquish ownership of an object of which you don’t have ownership.</li>
</ul>
<h2 id="Newly-introduced-for-ARC-Ownership-Qualifier"><a href="#Newly-introduced-for-ARC-Ownership-Qualifier" class="headerlink" title="Newly introduced for ARC: Ownership Qualifier"></a>Newly introduced for ARC: Ownership Qualifier</h2><p>In Objective-C, ‘id’ or each object type is used for object variable types.</p>
<p>Object types are pointer types of Objective-C classes, such as NSObject <em>.’id’ type is used to hide its class name. ‘id’ is equivalent to void</em> in the C language.</p>
<p>With ARC, ‘id’ and object type variables must have one of the following four ownership qualifiers:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> __<span class="keyword">strong</span></div><div class="line"><span class="number">2.</span> __<span class="keyword">weak</span></div><div class="line"><span class="number">3.</span> __<span class="keyword">unsafe_unretained</span></div><div class="line"><span class="number">4.</span> __autoreleasing</div></pre></td></tr></table></figure></p>
<p>You should decide which ownership qualifier is to be used for all the ‘id’ and object type variables in your source code. In this chapter, I explain hwo you should choos each qualifier one by one.</p>
<h3 id="strong-ownership-qualifier"><a href="#strong-ownership-qualifier" class="headerlink" title="__strong ownership qualifier"></a>__strong ownership qualifier</h3><p>The <strong>strong ownership qualifier is used as the default for ‘id’ and object types. It means that the variable obj in the following source code is </strong>strong qualified implicitly.<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">id</span> obj = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Without being explicitly qualified, ‘id’ or objects are treated as __strong. The above code is the same as:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">id</span> __<span class="keyword">strong</span> obj = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>The following is the same source code for a non-ARC environment.<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* non-ARC */</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">id</span> obj = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">    [obj release];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>This means the “release” method is automatically added on an ARC environment to release the created object with ownership.</p>
<p>We add comments on the ownership status:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="keyword">id</span> __<span class="keyword">strong</span> obj = [[<span class="built_in">NSObject</span> alloc] init];</div><div class="line">    <span class="comment">/**</span></div><div class="line">    * The variable obj is qualified with __strong.</div><div class="line">    * Which means, it has the ownership of the object.</div><div class="line">    **/</div><div class="line">&#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line">    * Leaving the scope of variable obj, its strong reference disappears.</div><div class="line">    * The object is release automatically,</div><div class="line">    * because no one has ownership, the objec is dispoed of.</div><div class="line">    */</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.superyoung.win/2017/01/29/learning_iOS/ARC_Rules/" data-id="ciyk0g7ew00037o0gac3lq8nl" class="article-share-link">Share</a>
      
        <a href="http://blog.superyoung.win/2017/01/29/learning_iOS/ARC_Rules/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ARC/">ARC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Coming-soon/">Coming soon...</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Objective-C/">Objective C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Programming/">Programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rules/">Rules</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/01/29/learning_swift/autoclosure/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Autoclosure and Lazy Caculation
        
      </div>
    </a>
  
  
    <a href="/2017/01/28/how_to_build_a_blog/blog_with_github_pages/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">使用 GitHub Pages 搭建博客指南</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/ARC/" style="font-size: 10px;">ARC</a> <a href="/tags/Block/" style="font-size: 10px;">Block</a> <a href="/tags/Coming-soon/" style="font-size: 15px;">Coming soon...</a> <a href="/tags/Coordinate/" style="font-size: 10px;">Coordinate</a> <a href="/tags/DataSource/" style="font-size: 10px;">DataSource</a> <a href="/tags/Delegate/" style="font-size: 10px;">Delegate</a> <a href="/tags/GitHub/" style="font-size: 10px;">GitHub</a> <a href="/tags/ObjC/" style="font-size: 10px;">ObjC</a> <a href="/tags/Objective-C/" style="font-size: 17.5px;">Objective C</a> <a href="/tags/Pages/" style="font-size: 10px;">Pages</a> <a href="/tags/Photoshop/" style="font-size: 10px;">Photoshop</a> <a href="/tags/Programming/" style="font-size: 20px;">Programming</a> <a href="/tags/Rules/" style="font-size: 10px;">Rules</a> <a href="/tags/RxSwift/" style="font-size: 10px;">RxSwift</a> <a href="/tags/Sequence/" style="font-size: 10px;">Sequence</a> <a href="/tags/Swift/" style="font-size: 15px;">Swift</a> <a href="/tags/System/" style="font-size: 10px;">System</a> <a href="/tags/UIAlertController/" style="font-size: 10px;">UIAlertController</a> <a href="/tags/UITableView/" style="font-size: 10px;">UITableView</a> <a href="/tags/autoclosure/" style="font-size: 10px;">autoclosure</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/instance/" style="font-size: 10px;">instance</a> <a href="/tags/keyboard/" style="font-size: 10px;">keyboard</a> <a href="/tags/language/" style="font-size: 10px;">language</a> <a href="/tags/lazy-caculation/" style="font-size: 10px;">lazy caculation</a> <a href="/tags/type/" style="font-size: 12.5px;">type</a> <a href="/tags/修图/" style="font-size: 10px;">修图</a> <a href="/tags/入门/" style="font-size: 10px;">入门</a> <a href="/tags/响应式/" style="font-size: 10px;">响应式</a> <a href="/tags/坐标系统/" style="font-size: 10px;">坐标系统</a> <a href="/tags/开发/" style="font-size: 10px;">开发</a>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/01/29/learning_swift/autoclosure/">Autoclosure and Lazy Caculation</a>
          </li>
        
          <li>
            <a href="/2017/01/29/learning_iOS/ARC_Rules/">ARC Rules</a>
          </li>
        
          <li>
            <a href="/2017/01/28/how_to_build_a_blog/blog_with_github_pages/">使用 GitHub Pages 搭建博客指南</a>
          </li>
        
          <li>
            <a href="/2017/01/27/PictureProcessing/50gray_buffing/">中性灰磨皮以及细节增强</a>
          </li>
        
          <li>
            <a href="/2017/01/25/learning_iOS/SequenceType/">关于 SequenceType</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Yu Shengyang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
<script>
var _hmt = _hmt || [];
(function() {var hm = document.createElement("script");
hm.src = "https://hm.baidu.com/hm.js?c2f3493bffeb398373d9cda4fd1c6636";
var s = document.getElementsByTagName("script")[0]; 
s.parentNode.insertBefore(hm, s);
})();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-91049921-1', 'auto');
  ga('send', 'pageview');
</script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
</nav>
    
<script>
  var disqus_shortname = 'blog-ysy';
  
  var disqus_url = 'http://blog.superyoung.win/2017/01/29/learning_iOS/ARC_Rules/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>