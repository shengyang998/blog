<!DOCTYPE html><html><head><meta charset="utf-8"><title>æ‰‹æŠŠæ‰‹æ•™ä½ Rxå“åº”å¼å¼€å‘ - å“åº”å¼åº”ç”¨å¼€å‘æç®€å…¥é—¨æ•™ç¨‹ | Tech. Design. Life.</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="å¾ˆå¤šé¢å‘å¯¹è±¡çš„å¼€å‘äººå‘˜éƒ½é‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼šè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¼€å‘äººå‘˜ä¸»åŠ¨åœ°å‘Šè¯‰ç³»ç»Ÿä»€ä¹ˆä¸œè¥¿æ”¹å˜äº†ï¼Œä»¥æ­¤æ¥è§¦å‘å“åº”ã€‚é‚£æœ‰äººå°±ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåŠæ³•å¯ä»¥è®©ç³»ç»Ÿè‡ªåŠ¨å‘ç°çŠ¶æ€çš„æ”¹å˜ï¼Œæ˜¯ä¸æ˜¯æ›´å¥½å‘¢ï¼Ÿè¿™å°±å¼•å‡ºäº†å“åº”å¼å¼€å‘æœ€åŸºæœ¬çš„æ¦‚å¿µâ€¦â€¦"><meta name="keywords" content="Programming,iOS,Swift,RxSwift,å“åº”å¼,å¼€å‘,å…¥é—¨"><meta property="og:type" content="article"><meta property="og:title" content="æ‰‹æŠŠæ‰‹æ•™ä½ Rxå“åº”å¼å¼€å‘ - å“åº”å¼åº”ç”¨å¼€å‘æç®€å…¥é—¨æ•™ç¨‹"><meta property="og:url" content="http://blog.superyoung.win/2017/01/25/learning_Rx/Reactive-Programming/index.html"><meta property="og:site_name" content="Tech. Design. Life."><meta property="og:description" content="å¾ˆå¤šé¢å‘å¯¹è±¡çš„å¼€å‘äººå‘˜éƒ½é‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼šè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¼€å‘äººå‘˜ä¸»åŠ¨åœ°å‘Šè¯‰ç³»ç»Ÿä»€ä¹ˆä¸œè¥¿æ”¹å˜äº†ï¼Œä»¥æ­¤æ¥è§¦å‘å“åº”ã€‚é‚£æœ‰äººå°±ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåŠæ³•å¯ä»¥è®©ç³»ç»Ÿè‡ªåŠ¨å‘ç°çŠ¶æ€çš„æ”¹å˜ï¼Œæ˜¯ä¸æ˜¯æ›´å¥½å‘¢ï¼Ÿè¿™å°±å¼•å‡ºäº†å“åº”å¼å¼€å‘æœ€åŸºæœ¬çš„æ¦‚å¿µâ€¦â€¦"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://blog.superyoung.win/images/Programming/rx_logo.png"><meta property="og:updated_time" content="2018-02-12T04:35:43.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="æ‰‹æŠŠæ‰‹æ•™ä½ Rxå“åº”å¼å¼€å‘ - å“åº”å¼åº”ç”¨å¼€å‘æç®€å…¥é—¨æ•™ç¨‹"><meta name="twitter:description" content="å¾ˆå¤šé¢å‘å¯¹è±¡çš„å¼€å‘äººå‘˜éƒ½é‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼šè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¼€å‘äººå‘˜ä¸»åŠ¨åœ°å‘Šè¯‰ç³»ç»Ÿä»€ä¹ˆä¸œè¥¿æ”¹å˜äº†ï¼Œä»¥æ­¤æ¥è§¦å‘å“åº”ã€‚é‚£æœ‰äººå°±ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåŠæ³•å¯ä»¥è®©ç³»ç»Ÿè‡ªåŠ¨å‘ç°çŠ¶æ€çš„æ”¹å˜ï¼Œæ˜¯ä¸æ˜¯æ›´å¥½å‘¢ï¼Ÿè¿™å°±å¼•å‡ºäº†å“åº”å¼å¼€å‘æœ€åŸºæœ¬çš„æ¦‚å¿µâ€¦â€¦"><meta name="twitter:image" content="http://blog.superyoung.win/images/Programming/rx_logo.png"><link rel="alternate" href="/atom.xml" title="Tech. Design. Life." type="application/atom+xml"><link rel="icon" href="/favicon.png"><link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/css/style.css"></head></html><body><div id="container"><div id="wrap"><header id="header"><div id="banner"></div><div id="header-outer" class="outer"><div id="header-title" class="inner"><h1 id="logo-wrap"><a href="/" id="logo">Tech. Design. Life.</a></h1></div><div id="header-inner" class="inner"><nav id="main-nav"><a id="main-nav-toggle" class="nav-icon"></a> <a class="main-nav-link" href="/">é¦–é¡µ</a> <a class="main-nav-link" href="/archives">å½’æ¡£</a></nav><nav id="sub-nav"><a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a> <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.superyoung.win"></form></div></div></div></header><div class="outer"><section id="main"><article id="post-learning_Rx/Reactive-Programming" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2017/01/25/learning_Rx/Reactive-Programming/" class="article-date"><time datetime="2017-01-25T07:47:23.000Z" itemprop="datePublished">2017-01-25</time></a></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">æ‰‹æŠŠæ‰‹æ•™ä½ Rxå“åº”å¼å¼€å‘ - å“åº”å¼åº”ç”¨å¼€å‘æç®€å…¥é—¨æ•™ç¨‹</h1></header><div class="article-entry" itemprop="articleBody"><p>å¾ˆå¤šé¢å‘å¯¹è±¡çš„å¼€å‘äººå‘˜éƒ½é‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼šè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¼€å‘äººå‘˜ä¸»åŠ¨åœ°å‘Šè¯‰ç³»ç»Ÿä»€ä¹ˆä¸œè¥¿æ”¹å˜äº†ï¼Œä»¥æ­¤æ¥è§¦å‘å“åº”ã€‚</p><p>é‚£æœ‰äººå°±ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåŠæ³•å¯ä»¥è®©ç³»ç»Ÿè‡ªåŠ¨å‘ç°çŠ¶æ€çš„æ”¹å˜ï¼Œæ˜¯ä¸æ˜¯æ›´å¥½å‘¢ï¼Ÿ</p><p>è¿™å°±å¼•å‡ºäº†å“åº”å¼å¼€å‘æœ€åŸºæœ¬çš„æ¦‚å¿µâ€¦â€¦<br><a id="more"></a></p><p><em>åŸæ–‡åœ¨æ­¤ï¼š<a href="https://www.raywenderlich.com/138547/getting-started-with-rxswift-and-rxcocoa" target="_blank" rel="noopener">Getting Started With RxSwift and RxCocoa by Ellen Shapiro on October 17, 2016</a></em></p><p><img src="/images/Programming/rx_logo.png" alt="ReactiveX Logo"></p><h2 id="0x00-åº"><a href="#0x00-åº" class="headerlink" title="0x00 åº"></a>0x00 åº</h2><p>å¾ˆå¤šé¢å‘å¯¹è±¡çš„å¼€å‘äººå‘˜éƒ½é‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼šè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¼€å‘äººå‘˜ä¸»åŠ¨åœ°å‘Šè¯‰ç³»ç»Ÿä»€ä¹ˆä¸œè¥¿æ”¹å˜äº†ï¼Œä»¥æ­¤æ¥è§¦å‘å“åº”ã€‚</p><p>é‚£æœ‰äººå°±ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåŠæ³•å¯ä»¥è®©ç³»ç»Ÿè‡ªåŠ¨å‘ç°çŠ¶æ€çš„æ”¹å˜ï¼Œæ˜¯ä¸æ˜¯æ›´å¥½å‘¢ï¼Ÿ</p><p>è¿™å°±å¼•å‡ºäº†å“åº”å¼å¼€å‘æœ€åŸºæœ¬çš„æ¦‚å¿µï¼šä½ çš„åº”ç”¨å¯ä»¥å¯¹çŠ¶æ€ç›´æ¥è¿›è¡Œå“åº”è€Œä¸éœ€è¦å¼€å‘äººå‘˜å‚ä¸ã€‚è¿™ç§å¼€å‘æ–¹å¼å¯ä»¥è®©å¼€å‘äººå‘˜æ›´åŠ ä¸“æ³¨äºé€»è¾‘çš„è¡¨è¾¾è€Œä¸æ˜¯å¦‚ä½•å¯¹çŠ¶æ€è¿›è¡Œä¿å­˜ã€‚</p><p>åœ¨ iOS ä¸­å¯ä»¥ä½¿ç”¨ Objc å’Œ Swift çš„ KVO å’Œ didSet ç­‰æ–¹æ³•ï¼Œä½†æ˜¯æœ‰æ—¶å€™å•Šè¿™äº›æ–¹æ³•å¯èƒ½å°±æ˜¾å¾—å¤ªç¬¨é‡äº†ï¼ŒObjc å’Œ Swift å‡æœ‰ä¸åŒçš„å“åº”å¼æ¡†æ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™é‡Œä¸»è¦ä»‹ç»çš„æ˜¯ swift çš„ RxSwift æ¡†æ¶ã€‚</p><p><a href="https://www.raywenderlich.com/126522/reactivecocoa-vs-rxswift" target="_blank" rel="noopener">å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šçš„èƒŒæ™¯ä¿¡æ¯ï¼Œå…³äºå„å¤§ä¸»æµæ¡†æ¶çš„åŒºåˆ«ï¼Œ <em>Rui Peres</em> å†™äº†ä¸€ç¯‡æ–‡ç« </a></p><h2 id="0x01-ä»€ä¹ˆæ˜¯-RxSwift-å’Œ-RxCocoa"><a href="#0x01-ä»€ä¹ˆæ˜¯-RxSwift-å’Œ-RxCocoa" class="headerlink" title="0x01 ä»€ä¹ˆæ˜¯ RxSwift å’Œ RxCocoa"></a>0x01 ä»€ä¹ˆæ˜¯ RxSwift å’Œ RxCocoa</h2><p>ReactiveX æ˜¯ä¸€ä¸ªæ”¯æŒå¾ˆå¤šç¼–ç¨‹è¯­è¨€å’Œå¹³å°è¯­è¨€å·¥å…·åº“ é¡¹ç›®ã€‚è€Œ RxSwift å’Œ RxCocoa æ˜¯ ReactiveX å¥—è£…çš„ä¸€éƒ¨åˆ†ã€‚</p><p>RxSwift æ˜¯ä¸€ä¸ªå’Œ Swift è¯­è¨€è¿›è¡Œäº¤äº’çš„æ¡†æ¶ï¼Œè€Œ RxCocoa åˆ™ä½¿å¾— Cocoa çš„ APIs æ›´å®¹æ˜“è¢« Reactive æŠ€æœ¯è°ƒç”¨ã€‚</p><p>RxSwift å’Œ RxCocoa å¯ä»¥é€šè¿‡ pod æ¥å®‰è£…ï¼Œå…·ä½“æ–¹æ³•è‡ªè¡ŒæŸ¥çœ‹å…¶ github é¡¹ç›®ä¸»é¡µã€‚</p><h2 id="0x02-åŸºæœ¬æ¦‚å¿µï¼šObservableè¢«è§‚å¯Ÿè€…-å’Œ-Observer-è§‚å¯Ÿè€…"><a href="#0x02-åŸºæœ¬æ¦‚å¿µï¼šObservableè¢«è§‚å¯Ÿè€…-å’Œ-Observer-è§‚å¯Ÿè€…" class="headerlink" title="0x02 åŸºæœ¬æ¦‚å¿µï¼šObservableè¢«è§‚å¯Ÿè€… å’Œ Observer è§‚å¯Ÿè€…"></a>0x02 åŸºæœ¬æ¦‚å¿µï¼š<code>Observable</code><em>è¢«è§‚å¯Ÿè€…</em> å’Œ <code>Observer</code> <em>è§‚å¯Ÿè€…</em></h2><p>æˆ‘æ›¾ç»è¢«è¿™äº›æ¦‚å¿µæ··æ·†äº†å¾ˆä¹…ï¼Œåœ¨ä¸åŒçš„æ–‡ç« ä¸­æœ‰ä¸åŒçš„ç§°å‘¼ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸­æ–‡åšå®¢ä¸­ï¼Œä»€ä¹ˆâ€œæµâ€ä¸â€œä¿¡å·â€é½é£ï¼Œå´å°‘æœ‰äººæŒ‰ç…§è‹±æ–‡å­—é¢çš„ç¿»è¯‘<br>Observable =&gt; è¢«è§‚å¯Ÿè€…ï¼ŒObserver =&gt; è§‚å¯Ÿè€…ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘å°†ä½¿ç”¨è¿™ä¸ªå­—é¢ç¿»è¯‘ï¼ŒåŸå› ç­‰ä½ çœ‹å®Œæ–‡ç« ä¼šä½“ä¼šåˆ°çš„ã€‚</p><p>å…¶å®ï¼Œè¿™ä¸ªè‹±æ–‡åå­—èµ·çš„å¾ˆæœ‰æ„æ€ï¼ŒObservable æ˜¯ä¸€ä¸ªå½¢å®¹è¯ï¼Œå…¶å®å°†å½¢å®¹è¯ä½œä¸ºä¸€ä¸ªç±»åéå¸¸è´´åˆ‡ï¼Œå…¶åœ¨ç‰›æ´¥è¯å…¸ä¸­çš„è§£é‡Šæ˜¯ï¼š<em>Able to be noticed or perceived</em>ï¼Œè€Œ Observer æ˜¯ä¸€ä¸ªåè¯ï¼Œåœ¨ç‰›æ´¥è¯å…¸ä¸­çš„è§£é‡Šæ˜¯ï¼š<em>A person who watches or notices something</em>ã€‚</p><p>è€Œè¿™ä¸¤ä¸ªè¯åœ¨ Rx ä¸­çš„å«ä¹‰æ˜¯ï¼š</p><ul><li>ä¸€ä¸ª<code>è¢«è§‚å¯Ÿè€…</code>æ˜¯ä¸€ä¸ªèƒ½å¤Ÿæäº¤é€šçŸ¥çš„ä¸œè¥¿ã€‚</li><li>ä¸€ä¸ª<code>è§‚å¯Ÿè€…</code>å¯ä»¥è®¢é˜…ä¸€ä¸ª<code>è¢«è§‚å¯Ÿè€…</code>å¯¹è±¡ï¼Œå¯ä»¥æ¥æ”¶å¯¹è±¡æ”¹å˜çš„é€šçŸ¥ï¼ŒåŒæ—¶è¿›è¡Œä¸€äº›è‡ªå®šä¹‰æ“ä½œã€‚</li></ul><h2 id="0x03-åŸºæœ¬æ¦‚å¿µï¼šDisposeBag-é”€æ¯åŒ…"><a href="#0x03-åŸºæœ¬æ¦‚å¿µï¼šDisposeBag-é”€æ¯åŒ…" class="headerlink" title="0x03 åŸºæœ¬æ¦‚å¿µï¼šDisposeBag é”€æ¯åŒ…"></a>0x03 åŸºæœ¬æ¦‚å¿µï¼š<code>DisposeBag</code> <em>é”€æ¯åŒ…</em></h2><p>æ˜¯ RxSwift å’Œ RxCocoa çš„å·¥å…·ï¼Œç”¨æ¥å¸®åŠ©å’Œ ARC å†…å­˜ç®¡ç†è¿›è¡Œäº¤äº’çš„å·¥å…·ã€‚è¿™æ˜¯ä¸€ä¸ªç»™<code>è§‚å¯Ÿè€…</code>å¯¹è±¡çš„è™šæ‹Ÿçš„ â€œåŒ…â€ï¼Œå½“å…¶çˆ¶å¯¹è±¡è¢« deallocate åï¼Œè§‚å¯Ÿè€…å¯¹è±¡çš„å†…å­˜ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚</p><p>å‡è®¾æŸä¸ªè§‚å¯Ÿè€…å¯¹è±¡çš„ä¸€ä¸ªå±æ€§æ˜¯ DisposeBag ï¼Œé‚£ä¹ˆå½“å®ƒçš„ <code>deinit()</code> æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ª â€œbagâ€ è¢«æ¸…ç©ºï¼Œå¹¶ä¸”æ¯ä¸ªè¢«é”€æ¯çš„è§‚å¯Ÿè€…éƒ½è‡ªåŠ¨çš„è§£é™¤è®¢é˜…ï¼Œè¿™å°±å…è®¸ ARC ç³»ç»Ÿå»æ­£å¸¸åœ°å›æ”¶å†…å­˜äº†ã€‚</p><p>æ²¡æœ‰ <code>DisposeBag</code> çš„è¯ï¼Œå°†ä¼šæœ‰ä¸¤ç§ç»“æœï¼š</p><ol><li>è¦ä¹ˆè§‚å¯Ÿè€…ä¼šåˆ›é€ ä¿ç•™ç¯ï¼Œé€ æˆå†…å­˜æ³„æ¼</li><li>è¦ä¹ˆå®ƒä¼šåœ¨å¯¹è±¡çš„å¤–é¢è¢«é‡Šæ”¾æ‰ï¼Œé€ æˆç¨‹åºå´©æºƒ</li></ol><p>æ‰€ä»¥ï¼Œä¸€å®šè¦è®°å¾—åœ¨è®¾ç½®è§‚å¯Ÿè€…å¯¹è±¡çš„æ—¶å€™å¢åŠ  DisposeBagã€‚</p><hr><h2 id="0x04-æ¥ä¸‹æ¥ä¸¾ä¸ªä¾‹å­ï¼šè´­ä¹°å·§å…‹åŠ›"><a href="#0x04-æ¥ä¸‹æ¥ä¸¾ä¸ªä¾‹å­ï¼šè´­ä¹°å·§å…‹åŠ›" class="headerlink" title="0x04 æ¥ä¸‹æ¥ä¸¾ä¸ªä¾‹å­ï¼šè´­ä¹°å·§å…‹åŠ›"></a>0x04 æ¥ä¸‹æ¥ä¸¾ä¸ªä¾‹å­ï¼šè´­ä¹°å·§å…‹åŠ›</h2><p><em>é¡¹ç›®æ–‡ä»¶ï¼š<a href="https://github.com/shengyang998/Chocolates-starter" target="_blank" rel="noopener">ä¼ é€é—¨</a></em></p><p>Build å¹¶ä¸”è¿è¡Œé¡¹ç›®ï¼Œç°åœ¨è¿™ä¸ª demo è¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨å“åº”å¼çš„ï¼Œæ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­ï¼Œå°†ä¼šå±•ç¤ºå¦‚ä½•ä½¿ç”¨å“åº”å¼æ¥å®Œæˆè¿™ä¸ª demoã€‚</p><h2 id="0x05-å“åº”å¼æ“ä½œè´­ç‰©è½¦æ•°é‡"><a href="#0x05-å“åº”å¼æ“ä½œè´­ç‰©è½¦æ•°é‡" class="headerlink" title="0x05 å“åº”å¼æ“ä½œè´­ç‰©è½¦æ•°é‡"></a>0x05 å“åº”å¼æ“ä½œè´­ç‰©è½¦æ•°é‡</h2><p>æ‰“å¼€ <code>ShoppingCart.swift</code>ï¼Œæ‰¾åˆ°è´­ç‰©è½¦å†…æ•°ç»„çš„å£°æ˜<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> chocolates = [<span class="type">Chocolate</span>]()</div></pre></td></tr></table></figure><p></p><p>ç°åœ¨è¿˜ä¸æ˜¯å“åº”å¼çš„ï¼Œè¦æƒ³å“åº”å¼ï¼Œå°†å…¶æ”¹æˆ<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> chocolates: <span class="type">Variable</span>&lt;[<span class="type">Chocolate</span>]&gt; = <span class="type">Variable</span>([])</div></pre></td></tr></table></figure><p></p><p>ä¸Šé¢è¯­å¥çš„ä½œç”¨è¯¦è¿°å¦‚ä¸‹ï¼š</p><ol><li>ä½ å®šä¹‰äº†ä¸€ä¸ª RxSwift çš„ Variableï¼Œè¿™ä¸ª Variable æ˜¯ Swift æ•°ç»„ç±»å‹çš„ï¼Œæ•°ç»„ç”¨äº† Chocolate ç±»å‹æ¥å®šä¹‰ã€‚</li><li><code>Variable</code> æ˜¯ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥å®ƒæ˜¯å¼•ç”¨ç±»å‹ã€‚ä¹Ÿå°±æ˜¯ chocolates æ˜¯ Variable çš„ä¸€ä¸ªå®ä¾‹ã€‚</li><li><code>Variable</code> æœ‰ä¸€ä¸ªå±æ€§å« <code>value</code>ã€‚è¿™é‡Œæ˜¯ä½ çš„ Chocolate æ•°ç»„å­˜æ”¾çš„åœ°æ–¹ã€‚</li><li><code>Variable</code> çš„è†œæ³•æ¥è‡ªäºä¸€ä¸ªå« <code>asObservable()</code> çš„æ–¹æ³•ã€‚ä½ å¯ä»¥å¢åŠ ä¸€ä¸ªè§‚å¯Ÿè€…æ¥ä»£æ›¿æ¯æ¬¡å»æ‰‹åŠ¨ check the valueã€‚</li><li>å¦å¤–ä»¥åè®¿é—®é‚£ä¸ªæ•°ç»„çš„æ—¶å€™ï¼Œéƒ½è¦é€šè¿‡ <code>value</code> æ¥è®¿é—®äº†ã€‚</li></ol><p>ä¿®å¤ Xcode å½“å‰æç¤ºçš„æ‰€æœ‰é”™è¯¯ï¼Œç„¶åç»§ç»­ä¸‹é¢çš„æ“ä½œï¼š</p><ol><li>åœ¨æ–‡ä»¶ <code>ChocolatesOfTheWorldViewController.swift</code> ä¸­å¢åŠ </li></ol><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</div></pre></td></tr></table></figure><ol><li>åœ¨ // MARK: Rx Setup ä¸‹é¢å¢åŠ </li></ol><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setupCartObserver</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="type">ShoppingCart</span>.sharedCart.chocolates.asObservable()</div><div class="line">    .subscribe(onNext:&#123;</div><div class="line">        (chocolates) <span class="keyword">in</span></div><div class="line">        <span class="keyword">self</span>.cartButton.title = <span class="string">"<span class="subst">\(chocolates.<span class="built_in">count</span>)</span> \u&#123;1f36b&#125;"</span></div><div class="line">        &#125;)</div><div class="line">    .addDisposableTo(disposeBag)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™å°†ä¼šè®¾ç½®ä¸€ä¸ªå“åº”å¼çš„è§‚å¯Ÿè€…å»è‡ªåŠ¨æ›´æ–°è´­ç‰©è½¦ã€‚</p><p>ä¸Šé¢çš„ä»£ç å…·ä½“åšäº†ä»€ä¹ˆï¼Ÿè¯¦è¿°å¦‚ä¸‹ï¼š</p><ol><li>é¦–å…ˆï¼Œè·å–è´­ç‰©è½¦çš„ chocolates as an Observable</li><li>æ¯æ¬¡ Observable ä¸­çš„å€¼æ›´æ–°åéƒ½ä¼šè°ƒç”¨å…¶è§‚å¯Ÿè€…çš„ <code>subscribe(onNext:)</code> ï¼Œå…¶ä¸­ä¼ å…¥çš„å‚æ•°å°±æ˜¯è¢«æ”¹å˜çš„å€¼ã€‚</li><li>è®°å¾—æ¯æ¬¡ subscribe åéƒ½è¦ addDisposableToã€‚</li></ol><p>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>viewDidLoad()</code> æ–¹æ³•ä¸­è°ƒç”¨ <code>setupCartObserver()</code>ï¼Œå¹¶ä¸”åˆ é™¤é‚£ä¸ªéç§æœ‰çš„ <code>updateCartButton()</code> æ–¹æ³•ï¼Œä¿®å¤é”™è¯¯ã€‚</p><h2 id="0x06-å“åº”å¼æ“ä½œ-TableView"><a href="#0x06-å“åº”å¼æ“ä½œ-TableView" class="headerlink" title="0x06 å“åº”å¼æ“ä½œ TableView"></a>0x06 å“åº”å¼æ“ä½œ TableView</h2><p>ç°åœ¨ä½ å·²ç»è®©è´­ç‰©è½¦å“åº”å¼äº†ï¼Œæ¥ä¸‹æ¥ä½ å°†ä¼šçœ‹åˆ°å¦‚ä½•ä½¿ç”¨ RxCocoa æ¥è®© UITableView å“åº”å¼ã€‚</p><p>RxCocoa åŒ…å«ä¸€äº› UI æ§ä»¶çš„å“åº”å¼çš„ APIï¼Œè¿™ä½¿å¾—ä½ å¯ä»¥æ§åˆ¶åƒ UITableView ç­‰æ§ä»¶è€Œä¸éœ€è¦ override ä»£ç†å’Œæ•°æ®æºæ–¹æ³•</p><p>ä¸ºäº†æ¼”ç¤ºæ€ä¹ˆåšï¼Œåˆ é™¤æ•´ä¸ª UITableViewDataSource å’Œ UITableViewDelegate æ‰©å±•ï¼Œç„¶ååˆ é™¤ viewDidLoad æ–¹æ³•é‡Œæ³¨å†Œ dataSource å’Œ delegate çš„è¯­å¥ã€‚</p><p>ç¼–è¯‘å¹¶ä¸”è¿è¡Œä¸€ä¸‹ï¼Œä½ å°†ä¼šå‘ç°æ•´ä¸ª TableView éƒ½ç©ºäº†ï¼Œé‚£ä¹ˆå¥½ï¼Œæ¥ä¸‹æ¥ä½ éœ€è¦ä½¿ TableView ä¸­çš„ä¸€äº›ä¸œè¥¿å“åº”åŒ–ï¼Œé¦–å…ˆï¼Œåœ¨æ–‡ä»¶ <code>ChocolatesOfTheWorldViewController.swift</code> ä¸­ï¼ŒæŠŠå±æ€§<code>europeanChocolates</code>æ”¹æˆä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> europeanChocolates = <span class="type">Observable</span>.just(<span class="type">Chocolate</span>.ofEurope)</div></pre></td></tr></table></figure><p></p><p><code>è¢«è§‚å¯Ÿè€…çš„å€¼</code>ä¸ä¼šæœ‰ä»»ä½•æ”¹å˜ï¼Œä½†æ˜¯å½“ä½ ä»ç„¶æƒ³è¦åƒä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„å€¼ä¸€æ ·è®¿é—®å®ƒçš„æ—¶å€™ï¼Œä½¿ç”¨<code>just(_:)</code>æ–¹æ³•ã€‚<br><em>æ³¨æ„ï¼Œä½¿ç”¨ <code>just(_:)</code> æ–¹æ³•å¸¸å¸¸ä»£è¡¨äº†ä½ è¿‡åº¦åœ°ä½¿ç”¨äº†Reactive Programmingã€‚å‡è®¾ä¸€ä¸ªå€¼æ°¸è¿œä¸ä¼šå˜ï¼Œä½ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä¸€ä¸ªè®¾è®¡ç”¨æ¥ react çš„ç¼–ç¨‹æŠ€å·§å‘¢ï¼Ÿåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ ä½¿ç”¨ Rx æ¥è®¾å®š TableViewCell å¦‚ä½•æ”¹å˜ã€‚ä½†æ˜¯æœ€å¥½ä½ èƒ½å¤Ÿæ—¶æ—¶æ³¨æ„ä½ æ˜¯æ€ä¹ˆä½¿ç”¨ Rx æŠ€æœ¯ã€‚ä¸è¦å› ä¸ºä½ æœ‰ä¸ªé”¤å­å°±æŠŠæ‰€æœ‰å›°éš¾çœ‹æˆé’‰å­ã€‚;)</em></p><p>ç°åœ¨ä½ å·²ç»è®© europeanChocolates å˜æˆè¢«è§‚å¯Ÿè€…äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å¢åŠ ä¸‹é¢çš„å‡½æ•°ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setupCellConfig</span><span class="params">()</span></span>&#123;</div><div class="line">    europeanChocolates.bindTo(tableView</div><div class="line">        .rx.items(cellIdentifier: <span class="type">ChocolateCell</span>.<span class="type">Identifier</span>, cellType: <span class="type">ChocolateCell</span>.<span class="keyword">self</span>))&#123;</div><div class="line">            (row, chocolate, cell) <span class="keyword">in</span></div><div class="line">            cell.configureWithChocolate(chocolate: chocolate)</div><div class="line">        &#125;.addDisposableTo(disposeBag)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>çŒœçŒœçœ‹è¿™é‡Œåšäº†ä»€ä¹ˆï¼Ÿå…¶å®è¿™é‡Œåšçš„äº‹æ˜¯ï¼š</p><ol><li>åœ¨è¿™é‡Œï¼Œä½ è°ƒç”¨äº†<code>bindTo(_:)</code>å»å…³è”è¢«è§‚å¯Ÿè€… europeanChocolatesï¼Œä¸Šé¢çš„ä»£ç åº”è¯¥æ¯è¡Œéƒ½è°ƒç”¨ä¸€æ¬¡</li><li>é€šè¿‡ <code>rx.</code> å¯ä»¥è®¿é—® RxCocoa å¯¹äº UI æ§ä»¶çš„æ‰©å±•ï¼Œåœ¨è¿™é‡Œæ˜¯ UITableView</li><li>è°ƒç”¨ Rx æ–¹æ³•ï¼Œ<code>items(cellIdentifier: cellType:)</code>ï¼Œä¼ å…¥ cell identifier å’Œ cell çš„ç±»å‹ã€‚è¿™å°†å…è®¸ Rx è°ƒç”¨ç¦»é˜Ÿæ–¹æ³•ï¼ˆdequeuing methodï¼‰</li><li>ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ª block ï¼Œæ¯ä¸€ä¸ªæ–° item éƒ½ä¼šæ‰§è¡Œè¿™ä¸ª blockã€‚ä½ ä¼šè·å¾—å…³äºè¿™ä¸€è¡Œçš„è¿”å›ä¿¡æ¯ï¼Œå’Œ cellï¼Œè¿™ä½¿å¾—å®ƒé…ç½® cell è¶…çº§ç®€å•ã€‚</li><li>åŠ å…¥ disposeBag</li></ol><p>é€šå¸¸æƒ…å†µä¸‹ç»è¿‡<code>tableView(_:numberOfRowsInSection:)</code>å’Œ<code>numberOfSection(in:)</code>è®¡ç®—çš„å€¼ç°åœ¨è‡ªåŠ¨æ ¹æ®è¢«è§‚å¯Ÿçš„å€¼æ¥è‡ªåŠ¨è®¡ç®—ã€‚è€Œ<code>tableView(_: cellForRowAt:)</code>ä»£ç†æ–¹æ³•å·²ç»è¢«é—­åŒ…ä»£æ›¿ã€‚</p><p>ç°åœ¨ï¼Œå»<code>viewDidLoad()</code>æ–¹æ³•ä¸­æ·»åŠ ä¸‹é¢è¿™è¡Œä»£ç ï¼Œè°ƒç”¨ä½ çš„æ–°è®¾ç½®æ–¹æ³•ï¼š<br><code>setupCellConfig()</code></p><p>ç°åœ¨ï¼Œå¦‚æœä½ ç‚¹å‡» tableView çš„ä»»ä½•ä¸€è¡Œï¼Œéƒ½ä¸ä¼šæœ‰ååº”ã€‚å› ä¸ºå½“ä½ åˆ é™¤<code>tableView(_: didSelectRowAt:)</code>çš„æ—¶å€™ï¼ŒtableView å·²ç»ä¸èƒ½è¯†åˆ«ç‚¹å‡»åŠ¨ä½œäº†ã€‚</p><p>ä¸ºäº†è§£å†³ç‚¹å‡»é—®é¢˜ï¼ŒRxCocoa æœ‰ä¸€ä¸ª<code>modelSelected(_:)</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª Observableï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒå»è§‚å¯Ÿå…³äºè¢«é€‰æ‹©å¯¹è±¡çš„ä¿¡æ¯ã€‚å¢åŠ å¦‚ä¸‹æ–¹æ³•ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setupCellTapHandling</span><span class="params">()</span></span>&#123;</div><div class="line">    tableView.rx.modelSelected(<span class="type">Chocolate</span>.<span class="keyword">self</span>) <span class="comment">//1</span></div><div class="line">    .subscribe(onNext:&#123; <span class="comment">//2</span></div><div class="line">        chocolate <span class="keyword">in</span></div><div class="line">        <span class="type">ShoppingCart</span>.sharedCart.chocolates.value.append(chocolate)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> selectedRowIndexPath = <span class="keyword">self</span>.tableView.indexPathForSelectedRow&#123;</div><div class="line">            <span class="keyword">self</span>.tableView.deselectRow(at: selectedRowIndexPath, animated:<span class="literal">true</span>)</div><div class="line">        &#125; <span class="comment">//3</span></div><div class="line">        &#125;).addDisposableTo(disposeBag) <span class="comment">//4</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>ä¸€æ­¥ä¸€æ­¥æ¥è§£é‡Šï¼š</p><ol><li>ç»™ table view çš„æ‰©å±•æ–¹æ³•<code>modelSelected(_:)</code>ä¼ å…¥ä¸€ä¸ª<code>Chocolate model</code>æ¥è·å–è¿”å›å€¼çš„æ­£ç¡®ç±»å‹ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª Observableã€‚</li><li>è·å–é‚£ä¸ª Observableï¼Œè°ƒç”¨<code>subscribe(onNext:)</code>æ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªå°¾éšé—­åŒ…ï¼Œè¿™ä¸ªé—­åŒ…å°†ä¼šåœ¨æ¯æ¬¡ model è¢«é€‰ä¸­çš„æ—¶å€™æ‰§è¡Œã€‚</li><li>å½“<code>self.tableView.indexPathForSelectedRow</code>æœ‰å€¼çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è¢«é€‰ä¸­çš„æ—¶å€™ï¼Œå–æ¶ˆé€‰æ‹©å®ƒã€‚</li><li>è®°å¾—åŠ å…¥ DisposeBag</li></ol><p>æœ€åè®°å¾—åœ¨ viewDidLoad ä¸­åŠ å…¥å¯¹ä¸Šé¢å‡½æ•°çš„è°ƒç”¨ã€‚</p><h2 id="0x07-æ–‡æœ¬å“åº”å¼è¾“å…¥"><a href="#0x07-æ–‡æœ¬å“åº”å¼è¾“å…¥" class="headerlink" title="0x07 æ–‡æœ¬å“åº”å¼è¾“å…¥"></a>0x07 æ–‡æœ¬å“åº”å¼è¾“å…¥</h2><p>åœ¨ä¸€èˆ¬åº”ç”¨ä¸­ï¼Œæ–‡å­—è¾“å…¥çš„å¤„ç†ä¸€èˆ¬éƒ½äº¤ç»™<code>UITextFieldDelegate</code>æ¥åšï¼Œé€šå¸¸å…¶æ–¹æ³•é‡Œä¼šåŒ…å«å¾ˆå¤šçš„ if/else æ¥å†³å®šå“ªä¸ªæ“ä½œå’Œé€»è¾‘åº”è¯¥è¢«æ‰§è¡Œã€‚Reactive åˆ™ä¸åŒã€‚ä½“ä¼šä¸€ä¸‹ï¼š</p><p>åœ¨<code>BillingInfoViewController.swift</code>ä¸­å¢åŠ  DisposeBag<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</div></pre></td></tr></table></figure><p></p><p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•æ ¹æ®ç”¨æˆ·çš„è¾“å…¥å±•ç¤ºä¿¡ç”¨å¡çš„å›¾æ ‡ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setupCardImageDisplay</span><span class="params">()</span></span>&#123;</div><div class="line">    cardType.asObservable()</div><div class="line">    .subscribe(onNext:&#123;</div><div class="line">        cardType <span class="keyword">in</span></div><div class="line">        <span class="keyword">self</span>.careditCardImageView.image = cardType.image</div><div class="line">        &#125;).addDisposableTo(disposeBag)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>æ¥ä¸‹æ¥å¤„ç†ä¸€äº›æœ‰è¶£çš„äº‹ï¼Œå¦‚æœç”¨æˆ·æ‰“å­—å¾ˆå¿«ï¼Œä½ å¯èƒ½ä¸æƒ³ç«‹å³å¤„ç†è¾“å…¥çš„å­—ç¬¦ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨æ‰§è¡Œç¼“æ…¢ã€‚è§£å†³åŠæ³•å¾ˆç®€å•ï¼Œä½¿ç”¨<code>throttle</code>ï¼ŒæŒ‰ç…§é—´éš”æ—¶é—´æ¥æ‰§è¡Œé€»è¾‘è€Œä¸æ˜¯æ¯æ¬¡æ”¹å˜éƒ½æ‰§è¡Œã€‚</p><p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p><p>é¦–å…ˆï¼Œåœ¨<code>BillingInfoViewController</code>ä¸­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">let</span> throttleInterVal = <span class="number">0.1</span></div></pre></td></tr></table></figure><p></p><p>è¿™é‡Œä»¥ç§’ä¸ºå•ä½å®šä¹‰äº† throttle length çš„å¸¸æ•°ã€‚</p><p>ç„¶åå†å¢åŠ å¦‚ä¸‹ä»£ç ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setupTextChangeHandling</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">let</span> creditCardValid = creditCardNumberTextField</div><div class="line">    .rx.text.throttle(throttleInterVal, scheduler: <span class="type">MainScheduler</span>.instance) <span class="comment">//1</span></div><div class="line">    .<span class="built_in">map</span>&#123; <span class="keyword">self</span>.validate(cardText: $<span class="number">0</span>) &#125; <span class="comment">//2</span></div><div class="line"></div><div class="line">    creditCardValid.subscribe(onNext:&#123;</div><div class="line">        <span class="keyword">self</span>.creditCardNumberTextField.valid = $<span class="number">0</span> <span class="comment">//3</span></div><div class="line">        &#125;).addDisposableTo(disposeBag) <span class="comment">//4</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p><strong>Note:å¦‚æœä½ åœ¨è®¾ç½® creditCardValid çš„æ—¶å€™å¾—åˆ°ä¸€ä¸ªâ€œ<em>Generic parameter R could not be inferred</em>â€é”™è¯¯ï¼Œä½ å¯ä»¥æ˜¾å¼åœ°æŒ‡æ˜ creditCardValid çš„ç±»å‹ï¼š<code>let creditCardValid: Observable</code>ã€‚ç†è®ºä¸Šç¼–è¯‘å™¨åº”è¯¥èƒ½å¤Ÿè‡ªåŠ¨æ¨æ–­å‡ºè¿™ä¸ªç±»å‹ï¼Œä½†æ˜¯æœ‰æ—¶å€™å®ƒå¯èƒ½ need some push ğŸ™‚</strong></p><p>å¥½ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç åšäº†ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­ä¸€æ­¥æ­¥åˆ†æï¼š</p><ol><li>ä½ å¯¹è¾“å…¥è¿›è¡Œäº† <code>throttle</code> æ“ä½œï¼Œæ‰€ä»¥éªŒè¯é€»è¾‘åªä¼šæ ¹æ®ä½ åœ¨ä¸Šé¢è®¾ç½®çš„æ—¶é—´æ¥æ‰§è¡Œã€‚<code>scheduler</code>å‚æ•°æ˜¯ä¸€ä¸ªæ›´é«˜çº§çš„æ¦‚å¿µï¼Œç®€å•æ¥è¯´å®ƒæ˜¯ç”¨æ¥ç»‘å®šä¸€ä¸ªçº¿ç¨‹çš„ï¼Œå¦‚æœä½ è¦ä½¿ç”¨ä¸»çº¿ç¨‹çš„è¯ï¼Œåˆ™è®¾ç½®ä¸º<code>MainScheduler</code>ï¼ˆUI æ“ä½œéƒ½éœ€è¦ä¸»çº¿ç¨‹ï¼‰</li><li>é€šè¿‡è°ƒç”¨<code>validate(cardText)</code>æ¥æŠŠ throttle è¾“å…¥æµ map æˆä¸€ä¸ª Boolean ç±»å‹çš„æµã€‚</li><li>è·å–å¹¶ä¸”è®¢é˜… creditCardValid ï¼ŒåŸºäºè¾“å…¥æ¥æ”¹å˜ text field çš„éªŒè¯çŠ¶æ€ã€‚</li><li>åŠ å…¥ DisposeBag ï¼Œä¸è´¹è¯äº†</li></ol><p>æ¥ä¸‹æ¥å“åº”å¼æ“ä½œ Expiration date å’Œ CVV Codeåœ¨<code>setupTextChangeHandling()</code>åº•éƒ¨ç»§ç»­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> expirationValid = expirationDateTextField</div><div class="line">.rx.text.throttle(throttleInterval, scheduler: <span class="type">MainScheduler</span>.instance)</div><div class="line">  .<span class="built_in">map</span> &#123; <span class="keyword">self</span>.validate(expirationDateText: $<span class="number">0</span>) &#125;</div><div class="line"></div><div class="line">expirationValid.subscribe(onNext: &#123;</div><div class="line">    <span class="keyword">self</span>.expirationDateTextField.valid = $<span class="number">0</span></div><div class="line">    &#125;).addDisposableTo(disposeBag)</div><div class="line"></div><div class="line"><span class="keyword">let</span> cvvValid = cvvTextField</div><div class="line">  .rx.text.<span class="built_in">map</span> &#123; <span class="keyword">self</span>.validate(cvvText: $<span class="number">0</span>) &#125;</div><div class="line"></div><div class="line">cvvValid</div><div class="line">  .subscribe(onNext: &#123; <span class="keyword">self</span>.cvvTextField.valid = $<span class="number">0</span> &#125;)</div><div class="line">  .addDisposableTo(disposeBag)</div></pre></td></tr></table></figure><p></p><p>ç°åœ¨ï¼Œä½ è·å–äº†ä¸‰ä¸ªæ–‡æœ¬æ¡†çš„æ‰€æœ‰è¢«è§‚å¯Ÿè€…çš„å€¼ï¼Œé‚£ä¹ˆå¢åŠ ä¸‹é¢çš„ä»£ç ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> everythingValid = <span class="type">Observable</span></div><div class="line">    .combineLatest(creditCardValid, expirationValid, cvvValid)&#123;</div><div class="line">    $<span class="number">0</span> &amp;&amp; $<span class="number">1</span> &amp;&amp; $<span class="number">2</span> <span class="comment">//all must be true</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">everythingValid.bindTo(purchaseButton.rx.enable)</div><div class="line">    .addDisposableTo(disposeBag)</div></pre></td></tr></table></figure><p></p><p>è¿™é‡Œç”¨åˆ°äº† Observable çš„ç±»æ–¹æ³•ï¼š<code>combineLatest()</code>ï¼Œå¥½å¥½ä½“ä¼šä¸€ä¸‹ã€‚</p><p><code>everythingValid</code>ç„¶åå’Œ UIButton åœ¨ rx æ‰©å±•å†…çš„<code>enabled</code>å±æ€§ç»‘å®šäº†ï¼Œæ‰€ä»¥æŒ‰é’®çš„çŠ¶æ€è¢« <code>everythingValid</code> çš„å€¼æ¥æ§åˆ¶ã€‚å¦‚æœæ‰€æœ‰ä¸‰ä¸ªæ–‡æœ¬åŸŸéƒ½ä¸ºçœŸï¼ŒæŒ‰é’®æ‰èƒ½è¢«æŒ‰ä¸‹</p><p>å¥½çš„ï¼Œç°åœ¨ä½ å·²ç»å†™å¥½è®¾ç½®æ–¹æ³•äº†ï¼Œåœ¨<code>viewDidLoad()</code>ä¸­è°ƒç”¨å®ƒå§ï¼š<br></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setupCardImageDisplay()</div><div class="line">setupTextChangeHandling()</div></pre></td></tr></table></figure><p></p><p>æ¥ä¸‹æ¥è¿è¡Œä¸€ä¸‹çœ‹çœ‹æ•ˆæœï¼Œå¥½å¥½ä½“ä¼šï¼Œå¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå°½ç®¡æäº¤ issueã€‚</p><h2 id="0x08-å°¾å£°"><a href="#0x08-å°¾å£°" class="headerlink" title="0x08 å°¾å£°"></a>0x08 å°¾å£°</h2><p>å¦‚æœä½ æƒ³å¤šå°è¯•ä¸€ä¸‹ï¼Œè¯•è¯•çœ‹ï¼š</p><ol><li>è®© <code>CartViewController</code> ä½¿ç”¨ä¸€ä¸ªå“åº”å¼çš„ TableView æ¥å±•ç¤ºè´­ç‰©è½¦çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª Labelã€‚</li><li>å…è®¸ç”¨æˆ·ç›´æ¥åœ¨è´­ç‰©è½¦é¡µé¢å¢åŠ æˆ–è€…ç§»é™¤å·§å…‹åŠ›ï¼Œè‡ªåŠ¨æ›´æ–°æ€»ä»·ã€‚</li></ol><p>å¥½äº†ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå“åº”å¼ç¼–ç¨‹çš„å†…å®¹çš„è¯ï¼Œä¸‹é¢çš„å†…å®¹ä½ ç»å¯¹ä¸ä¼šé”™è¿‡ï¼š</p><ol><li><a href="http://slack.rxswift.org/" target="_blank" rel="noopener">RxSwift Slack</a></li><li><a href="https://github.com/ReactiveX/RxSwift/blob/master/Documentation/GettingStarted.md" target="_blank" rel="noopener">RxSwiftâ€™s Getting Started guide</a></li><li><a href="https://realm.io/news/slug-max-alexander-functional-reactive-rxswift/" target="_blank" rel="noopener">Max Alexanderâ€™s talk on Rx at Realm</a></li><li><a href="http://rx-marin.com" target="_blank" rel="noopener">rx-marin</a></li></ol></div><footer class="article-footer"><a data-url="http://blog.superyoung.win/2017/01/25/learning_Rx/Reactive-Programming/" data-id="cjctwd6b5000b39fye309m398" class="article-share-link">Share</a> <a href="http://blog.superyoung.win/2017/01/25/learning_Rx/Reactive-Programming/#disqus_thread" class="article-comment-link">ç•™è¨€</a><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Programming/">Programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RxSwift/">RxSwift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/å…¥é—¨/">å…¥é—¨</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/å“åº”å¼/">å“åº”å¼</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/å¼€å‘/">å¼€å‘</a></li></ul></footer></div><nav id="article-nav"><a href="/2017/01/25/learning_iOS/SequenceType/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">å…³äº SequenceType</div></a><a href="/2017/01/15/learning_iOS/debugPrint/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">Debug Print in iOS Programming</div></a></nav></article><section id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">æ ‡ç­¾äº‘</h3><div class="widget tagcloud"><a href="/tags/ARC/" style="font-size:10px">ARC</a> <a href="/tags/Bit-plane/" style="font-size:10px">Bit-plane</a> <a href="/tags/Block/" style="font-size:10px">Block</a> <a href="/tags/Class/" style="font-size:10px">Class</a> <a href="/tags/Coming-soon/" style="font-size:13.33px">Coming soon...</a> <a href="/tags/Command/" style="font-size:10px">Command</a> <a href="/tags/Computation/" style="font-size:10px">Computation</a> <a href="/tags/Coordinate/" style="font-size:10px">Coordinate</a> <a href="/tags/DATE/" style="font-size:10px">DATE</a> <a href="/tags/DATETIME/" style="font-size:10px">DATETIME</a> <a href="/tags/DataFrame/" style="font-size:10px">DataFrame</a> <a href="/tags/DataSource/" style="font-size:10px">DataSource</a> <a href="/tags/Debug/" style="font-size:10px">Debug</a> <a href="/tags/Delegate/" style="font-size:10px">Delegate</a> <a href="/tags/Difference/" style="font-size:11.67px">Difference</a> <a href="/tags/Digital/" style="font-size:10px">Digital</a> <a href="/tags/Driver/" style="font-size:11.67px">Driver</a> <a href="/tags/Emacs/" style="font-size:10px">Emacs</a> <a href="/tags/Enum/" style="font-size:10px">Enum</a> <a href="/tags/Experience/" style="font-size:10px">Experience</a> <a href="/tags/G/" style="font-size:10px">G++</a> <a href="/tags/GCC/" style="font-size:10px">GCC</a> <a href="/tags/GDB/" style="font-size:10px">GDB</a> <a href="/tags/GNU/" style="font-size:10px">GNU</a> <a href="/tags/Git/" style="font-size:10px">Git</a> <a href="/tags/GitHub/" style="font-size:10px">GitHub</a> <a href="/tags/Grubbs/" style="font-size:10px">Grubbs</a> <a href="/tags/Guide/" style="font-size:11.67px">Guide</a> <a href="/tags/High-Sierra/" style="font-size:10px">High Sierra</a> <a href="/tags/Image/" style="font-size:10px">Image</a> <a href="/tags/Installation/" style="font-size:10px">Installation</a> <a href="/tags/LLDB/" style="font-size:10px">LLDB</a> <a href="/tags/Language/" style="font-size:11.67px">Language</a> <a href="/tags/Linux/" style="font-size:11.67px">Linux</a> <a href="/tags/Matlab/" style="font-size:11.67px">Matlab</a> <a href="/tags/MySQL/" style="font-size:10px">MySQL</a> <a href="/tags/OS-X/" style="font-size:11.67px">OS X</a> <a href="/tags/ObjC/" style="font-size:10px">ObjC</a> <a href="/tags/Objective-C/" style="font-size:15px">Objective C</a> <a href="/tags/Pages/" style="font-size:10px">Pages</a> <a href="/tags/Pandas/" style="font-size:10px">Pandas</a> <a href="/tags/Parallel/" style="font-size:10px">Parallel</a> <a href="/tags/Path/" style="font-size:10px">Path</a> <a href="/tags/Photoshop/" style="font-size:10px">Photoshop</a> <a href="/tags/Processing/" style="font-size:10px">Processing</a> <a href="/tags/Programming/" style="font-size:20px">Programming</a> <a href="/tags/Python/" style="font-size:13.33px">Python</a> <a href="/tags/Redirect/" style="font-size:10px">Redirect</a> <a href="/tags/Rules/" style="font-size:10px">Rules</a> <a href="/tags/RxSwift/" style="font-size:13.33px">RxSwift</a> <a href="/tags/SVN/" style="font-size:10px">SVN</a> <a href="/tags/Science/" style="font-size:10px">Science</a> <a href="/tags/Sequence/" style="font-size:10px">Sequence</a> <a href="/tags/Series/" style="font-size:10px">Series</a> <a href="/tags/Server/" style="font-size:13.33px">Server</a> <a href="/tags/Shell/" style="font-size:11.67px">Shell</a> <a href="/tags/Sierra/" style="font-size:10px">Sierra</a> <a href="/tags/Spotlight/" style="font-size:10px">Spotlight</a> <a href="/tags/Struct/" style="font-size:10px">Struct</a> <a href="/tags/Swift/" style="font-size:16.67px">Swift</a> <a href="/tags/System/" style="font-size:10px">System</a> <a href="/tags/TIMESTAMP/" style="font-size:10px">TIMESTAMP</a> <a href="/tags/TenserFlow/" style="font-size:10px">TenserFlow</a> <a href="/tags/Tutorial/" style="font-size:11.67px">Tutorial</a> <a href="/tags/UIAlertController/" style="font-size:10px">UIAlertController</a> <a href="/tags/UITableView/" style="font-size:10px">UITableView</a> <a href="/tags/Unit/" style="font-size:11.67px">Unit</a> <a href="/tags/Wavelet/" style="font-size:10px">Wavelet</a> <a href="/tags/Working/" style="font-size:10px">Working</a> <a href="/tags/autoclosure/" style="font-size:10px">autoclosure</a> <a href="/tags/blog/" style="font-size:10px">blog</a> <a href="/tags/filter/" style="font-size:10px">filter</a> <a href="/tags/hexo/" style="font-size:10px">hexo</a> <a href="/tags/iOS/" style="font-size:18.33px">iOS</a> <a href="/tags/instance/" style="font-size:10px">instance</a> <a href="/tags/keyboard/" style="font-size:10px">keyboard</a> <a href="/tags/language/" style="font-size:10px">language</a> <a href="/tags/lazy-evaluation/" style="font-size:10px">lazy evaluation</a> <a href="/tags/log/" style="font-size:10px">log</a> <a href="/tags/macOS/" style="font-size:11.67px">macOS</a> <a href="/tags/map/" style="font-size:10px">map</a> <a href="/tags/parfor/" style="font-size:10px">parfor</a> <a href="/tags/reduce/" style="font-size:10px">reduce</a> <a href="/tags/type/" style="font-size:11.67px">type</a> <a href="/tags/which/" style="font-size:10px">which</a> <a href="/tags/ä¼˜åŒ–ç®—æ³•/" style="font-size:10px">ä¼˜åŒ–ç®—æ³•</a> <a href="/tags/ä¼˜åŒ–é—®é¢˜/" style="font-size:10px">ä¼˜åŒ–é—®é¢˜</a> <a href="/tags/ä¿®å›¾/" style="font-size:10px">ä¿®å›¾</a> <a href="/tags/å…¥é—¨/" style="font-size:10px">å…¥é—¨</a> <a href="/tags/å“åº”å¼/" style="font-size:13.33px">å“åº”å¼</a> <a href="/tags/å™ªå£°/" style="font-size:10px">å™ªå£°</a> <a href="/tags/åæ ‡ç³»ç»Ÿ/" style="font-size:10px">åæ ‡ç³»ç»Ÿ</a> <a href="/tags/å°æ³¢/" style="font-size:10px">å°æ³¢</a> <a href="/tags/å¼€å‘/" style="font-size:13.33px">å¼€å‘</a> <a href="/tags/å¼‚å¸¸å€¼/" style="font-size:10px">å¼‚å¸¸å€¼</a> <a href="/tags/æ•™ç¨‹/" style="font-size:11.67px">æ•™ç¨‹</a> <a href="/tags/æœåŠ¡å™¨/" style="font-size:11.67px">æœåŠ¡å™¨</a> <a href="/tags/æœºå™¨å­¦ä¹ /" style="font-size:10px">æœºå™¨å­¦ä¹ </a> <a href="/tags/æ¨¡æ‹Ÿé€€ç«ç®—æ³•/" style="font-size:10px">æ¨¡æ‹Ÿé€€ç«ç®—æ³•</a> <a href="/tags/ç¥ç»ç½‘ç»œ/" style="font-size:10px">ç¥ç»ç½‘ç»œ</a> <a href="/tags/ç¼ºå¤±å€¼/" style="font-size:10px">ç¼ºå¤±å€¼</a> <a href="/tags/é—ä¼ ç®—æ³•/" style="font-size:10px">é—ä¼ ç®—æ³•</a> <a href="/tags/é…ç½®/" style="font-size:11.67px">é…ç½®</a> <a href="/tags/é™å™ª/" style="font-size:10px">é™å™ª</a></div></div><div class="widget-wrap"><h3 class="widget-title">æœ€æ–°æ–‡ç« </h3><div class="widget"><ul><li><a href="/2018/01/25/notes/install_tensorflow_from_source_for_macos/">Instruction of Installing TensorFlow From Source</a></li><li><a href="/2017/10/28/learning_emacs/start_server/">Setting Up Emacs Server to Speed Up Your Emacs</a></li><li><a href="/2017/10/07/learning_python/compile_executable_with_cython/">ç”¨ Cython æŠŠ Python æ–‡ä»¶ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶</a></li><li><a href="/2017/10/01/notes/update_high_sierra/">å‡çº§ macOS High Sierra å¤±è´¥æ€ä¹ˆåŠï¼ŸğŸ˜°</a></li><li><a href="/2017/05/09/learning_data_analysis_with_python/about_pandas/">Python ä¸­çš„æ•°æ®æŒ–æ˜åº“ Pandas çš„å¸¸ç”¨æ“ä½œå’Œå®¹æ˜“å‡ºç°è¯¯è§£çš„åœ°æ–¹</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">å½’æ¡£</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">ä¸€æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">åæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">äº”æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">å››æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">ä¸‰æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">äºŒæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">ä¸€æœˆ 2017</a></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2018 Yu Shengyang<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></div></div></footer><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c2f3493bffeb398373d9cda4fd1c6636";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-91049921-1","auto"),ga("send","pageview")</script></div><nav id="mobile-nav"><a href="/" class="mobile-nav-link">é¦–é¡µ</a> <a href="/archives" class="mobile-nav-link">å½’æ¡£</a></nav><script>var disqus_shortname="blog-ysy",disqus_url="http://blog.superyoung.win/2017/01/25/learning_Rx/Reactive-Programming/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/js/script.js"></script></div></body>