var kpfLayerCounter=0;var eventOverallDuration=0;var KPFPlaybackController=Class.create({initialize:function(e,t){this.domNode=t;this.kpfEvent=null},destroy:function(){this.removeEvent();this.domNode=null},removeEvent:function(){if(this.kpfEvent){this.kpfEvent.destroy();delete this.kpfEvent;this.kpfEvent=null;while(this.domNode.childNodes.length>0){this.domNode.removeChild(this.domNode.childNodes[0])}}},renderEvent:function(e){this.removeEvent();this.kpfEvent=e;this.kpfEvent.renderEvent(this.domNode)},renderEffects:function(){var e=this.kpfEvent.renderEffects(this.kpfEvent.event.effects);return e},animateEffects:function(e){this.kpfEvent.animateEffects(e)},eventOverallEndTime:function(){return this.kpfEvent.eventOverallEndTime}});var KPFEvent=Class.create({initialize:function(e){this.slideId=e.slideId;this.slideIndex=e.slideIndex;this.sceneIndex=e.sceneIndex;this.animationSupported=e.animationSupported;this.event=e.event;this.baseLayer={};this.effects=[];this.cssRenderer={};this.eventOverallEndTime=0;this.overallEndTimeInternal()},destroy:function(){this.baseLayer.destroy();this.cssRenderer.destroy();for(var e=0,t=this.effects.length;e<t;e++){this.effects[e].destroy()}delete this.baselayer;delete="" this.cssrenderer;delete="" this.effects;delete="" this.event;this.slideid="null;this.slideIndex=null;this.sceneIndex=null;this.animationSupported=null;this.eventOverallEndTime=null},addAnimationsToIdenticalLayer:function(e,t){if(e.animations&&e.animations.length">0){for(var i=0,n=e.animations.length;i<n;i++){t.animations.push(e.animations[i])}}if(e.layers&&e.layers.length>0){for(var r=0,a=e.layers.length;r<a;r++){this.addanimationstoidenticallayer(e.layers[r],t.layers[r])}}},processeffects:function(e){var t="[];for(var" i="0;i<e.length;i++){var" n="e[i];if(n.type==="actionBuild"){var" r="false;var" a;for(var="" o="0,s=t.length;o<s;o++){if(t[o].type==="actionBuild"&&t[o].objectID===n.objectID){a=o;r=true;break}}if(r){this.addAnimationsToIdenticalLayer(n.baseLayer,t[a].baseLayer);if(n.beginTime<t[a].beginTime){t[a].beginTime=n.beginTime}if(n.beginTime+n.duration">t[a].beginTime+t[a].duration){t[a].duration=n.beginTime+n.duration}for(var l=0,m=n.effects.length;l<m;l++){t[a].effects.push(n.effects[l])}if(t[a].names==null){t[a].names=[]}t[a].names.push(n.name)}else{t.push(n)}}else{t.push(n)}}for(var i="0,s=t.length;i<s;i++){t[i].effects=this.processEffects(t[i].effects)}return" t},rendereffects:function(e){var="" t="[];for(var" r="new" kpfeffect(e[i],this.animationsupported);var="" a="false;this.cssRenderer.initRendererFlags(r);if(r.baseLayer==null){this.renderAudioOnlyEffect(r)}else{if(r.type==="actionBuild"&&!r.isEmphasisBuild){for(var" o="0,s=this.effects.length;o<s;o++){if(this.effects[o].objectID===r.objectID){if(this.effects[o].type==="actionBuild"){a=true}else{a=false}}}}if(this.baseLayer.objectID===r.objectID){var" l="new" kpflayer(r.baselayer,{animationsupported:this.animationsupported,name:r.name,type:r.type,objectid:r.objectid});var="" m="document.getElementById("layer"+this.baseLayer.layerId);var" f="m.parentNode;var" c="document.createElement("div");c.setAttribute("id","layer"+l.layerId);this.baseLayer=l;r.kpfLayer=l;this.cssRenderer.layer=l;this.cssRenderer.domNode=c;this.cssRenderer.draw(f);f.removeChild(m)}else{this.renderEffect(this.baseLayer,r,a)}}this.effects.push(r);t.push(r)}return" t},rendereffect:function(e,t,i){var="" n;for(var="" kpflayer(t.baselayer,{animationsupported:this.animationsupported,name:t.name,type:t.type,objectid:t.objectid},e.bounds.offset);var="" s="layer" +e.layers[r].layerid;var="" n},renderevent:function(e){var="" kpflayer(this.event.baselayer,t);this.cssrenderer="new" kpfcssrenderer(this.baselayer,this.sceneindex,this.animationsupported,this.effects);this.cssrenderer.draw(e)},renderaudioonlyeffect:function(e){if(e.name!="renderMovie" ){return}var="" n="gShowController.audioCache[i];if(n==null){var" audio(r);if(t){if(t.loopmode&&t.loopmode="=="looping"){n.loop=true}if(t.volume){n.volume=t.volume}}gShowController.audioCache[i]=n}n.play()},animateEffects:function(e){for(var">0){setTimeout(this.handleEffectDidComplete.bind(this,e),(e.beginTime+e.duration)*1e3)}},handleEffectDidComplete:function(e){var t=this.renderEffects(e.effects);for(var i=0,n=t.length;i<n;i++){this.animateeffect(t[i])}},overallendtime:function(){return this.eventoverallendtime},overallendtimeinternal:function(){for(var="" e="0,t=this.event.effects.length;e<t;e++){var" i="0;var" n="this.event.effects[e];this.calculateOverallEndTime(i,n)}},calculateOverallEndTime:function(e,t){var">this.eventOverallEndTime){this.eventOverallEndTime=i}for(var n=0,r=t.effects.length;n<r;n++){this.calculateoverallendtime(i,t.effects[n])}}});var kpfeffect="Class.create({initialize:function(e,t){this.type=e.type;this.name=e.name;this.beginTime=e.beginTime;this.duration=e.duration;this.objectID=e.objectID;this.baseLayer=e.baseLayer;if(kEmphasisEffects.indexOf(this.name)">-1){this.isEmphasisBuild=true}if(e.movie){this.movie=e.movie}this.effects=[];this.addSubEffect(e.effects,t)},destroy:function(){for(var e=0,t=this.effects.length;e<t;e++){this.destroyeffect(this.effects[e])}this.type=null;this.name=null;this.begintime=null;this.duration=null;this.objectid=null;delete this.kpflayer;delete="" this.effects;delete="" this.baselayer;if(this.movie){delete="" this.movie}if(this.currentkpflayer){delete="" this.currentkpflayer}},destroyeffect:function(e){for(var="" t="0,i=e.effects.length;t<i;t++){this.destroyEffect(e.effects[t])}e.type=null;e.name=null;e.beginTime=null;e.duration=null;e.objectID=null;delete" e.kpflayer;delete="" e.effects;delete="" e.baselayer;if(e.movie){delete="" e.movie}if(e.currentkpflayer){delete="" e.currentkpflayer}},addsubeffect:function(e,t){for(var="" i="0,n=e.length;i<n;i++){var" r="new" kpfeffect(e[i],t);this.effects.push(r)}}});var="" kpfmovie="Class.create({initialize:function(e){this.objectID=e.objectID;this.movieId=e.movieId;this.width=e.width;this.height=e.height;this.sceneIndex=e.sceneIndex;this.textureId=e.textureId;this.src=e.src;this.showControls=e.showControls;this.previousSiblingTextureId=e.previousSiblingTextureId;this.movieDiv=e.movieDiv;var" e="this.videoElement;if(e){e.pause();e.src=""}},setDefaultStyle:function(){var" kpfcssrenderer="Class.create({initialize:function(e,t,i,n){this.textureId=e.textureId;this.nativeWidth=e.bounds.width;this.nativeHeight=e.bounds.height;this.opacity=e.opacity;this.visibility=e.hidden===true?"hidden":"visible";this.textureTransform=e.textureTransform;this.affineTransform=e.affineTransform;this.anchorPoint=e.anchorPoint;this.contentsRect=e.contentsRect;this.layer=e;this.sceneIndex=t;this.animationSupported=i;this.enableCompositingUsingBackface=false;this.enablePreserve3DFromParent=false;if(n.length">0){this.initRendererFlags(n[0])}this.domNode=document.createElement("div");this.domNode.setAttribute("id","layer"+e.layerId)},initRendererFlags:function(e){if(e.type==="transition"&&e.name!="apple:ca-swing"&&e.name!="com.apple.iWork.Keynote.BLTSwoosh"){this.enableCompositingUsingBackface=true;this.enablePreserve3DFromParent=true;if(isChrome&&(e.name==="apple:ca-push"||e.name==="com.apple.iWork.Keynote.BLTFadeThruColor")){this.enableCompositingUsingBackface=false;this.enablePreserve3DFromParent=false}}else{this.enableCompositingUsingBackface=false;this.enablePreserve3DFromParent=false}if(e.name==="apple:apple-grid"){this.isGridTransition=true}else{if(e.name==="com.apple.iWork.Keynote.BLTMosaicFlip"){this.isMosaicTransition=true}else{if(e.name==="com.apple.iWork.Keynote.BLTSwoosh"&&e.type==="transition"){this.isSwooshTransition=true}}}},destroy:function(){this.textureId=null;this.nativeWidth=null;this.nativeHeight=null;this.opacity=null;this.visibility=null;this.textureTransform=null;this.affineTransform=null;this.anchorPoint=null;this.textureAnimation=null;this.contentsRect=null;this.requiresPerspectiveTransform=null;this.sceneIndex=null;if(this.domNode.hasChildNodes()){while(this.domNode.childNodes.length>0){this.domNode.removeChild(this.domNode.firstChild)}}this.domNode=null},addAnimationNode:function(e,t,i,n){if(t==null){return e}var r=t.shift();if(r==null){return e}var a=document.createElement("div");var o=i+"-"+escapeTextureId(r);a.setAttribute("id",o);if(n.initialState.masksToBounds){setElementProperty(a,"overflow","hidden")}if(this.enableCompositingUsingBackface){setElementProperty(a,kBackfaceVisibilityPropertyName,"hidden")}else{if(this.isSwooshTransition){setElementProperty(a,kTransformPropertyName,"translateZ(0px)")}}this.setStyle(a,"0px","0px",e.style.width,e.style.height,kPositionAbsolutePropertyValue,null,null);setElementProperty(a,kTransformStylePropertyName,kTransformStylePreserve3DPropertyValue);if(n.anchorPoint.pointX!=.5||n.anchorPoint.pointY!=.5){setElementProperty(a,kTransformOriginPropertyName,n.anchorPoint.pointX*100+"% "+n.anchorPoint.pointY*100+"%")}if(n.transformOriginZValue!=""&&r!="opacity"&&r!="doubleSided"){if(r!="anchorPointZ"){if(Prototype.Browser.Gecko){setElementProperty(a,kTransformOriginPropertyName,n.anchorPoint.pointX*100+"% "+n.anchorPoint.pointY*100+"% "+n.transformOriginZValue+"px")}else{setElementProperty(a,kTransformOriginZPropertyName,n.transformOriginZValue+"px");if(navigator.userAgent.lastIndexOf("Chrome/")<=0){setelementproperty(a,ktransformpropertyname,"translatez("+n.transformoriginzvalue+"px)")}}}}e.appendchild(a);return this.addanimationnode(a,t,i,n)},createnodes:function(e,t,i){var="" n="this.addNode(e,t,i);return" n},addnode:function(e,t,i){var="" +i.layerid;var="" r="document.createElement("div");r.setAttribute("id",n);setElementProperty(r,"pointer-events","none");var" a="i.contentsRect.x;var" o="i.contentsRect.y;var" s="i.contentsRect.width;var" l="i.contentsRect.height;var" m="i.affineTransform[0];var" f="i.affineTransform[1];var" c="i.affineTransform[2];var" u="i.affineTransform[3];var" h="i.affineTransform[4];var" d="i.affineTransform[5];var" p="matrix(" +m+","+f+","+c+","+u+","+(h+i.bounds.offset.pointx)+","+(d+i.bounds.offset.pointy)+")";var="" y="i.bounds;var" v="y.width;var" g="y.height;this.setStyle(r,"0px","0px",v+"px",g+"px",kPositionAbsolutePropertyValue,i.opacity,i.visibility);setElementProperty(r,kTransformPropertyName,p);if(i.anchorPoint.pointX!=.5||i.anchorPoint.pointY!=.5){setElementProperty(r,kTransformOriginPropertyName,i.anchorPoint.pointX*100+"%" "+i.anchorpoint.pointy*100+"%")}if(i.initialstate.maskstobounds){setelementproperty(r,"overflow","hidden")}e.appendchild(r);var="" p;if(this.animationsupported){p="this.addAnimationNode(r,i.divNames,n,i)}else{P=r}if(i.isTransition&&this.enablePreserve3DFromParent){if(t.sublayerTransform[11]!=0){setElementProperty(r,kTransformStylePropertyName,kTransformStylePreserve3DPropertyValue)}if(i.sublayerTransform[11]!=0){setElementProperty(r,kPerspectivePropertyName,gShowController.stageManager.perspective+"px");setElementProperty(r,kTransformStylePropertyName,kTransformStylePreserve3DPropertyValue)}}else{if(t.sublayerTransform[11]!=0){setElementProperty(e,kPerspectivePropertyName,gShowController.stageManager.perspective+"px");setElementProperty(r,kTransformStylePropertyName,kTransformStylePreserve3DPropertyValue)}else{setElementProperty(r,kTransformStylePropertyName,kTransformStyleFlatPropertyValue)}}if(isChrome){if(this.enableCompositingUsingBackface){setElementProperty(r,kBackfaceVisibilityPropertyName,"hidden")}else{if(this.isSwooshTransition){setElementProperty(r,kTransformPropertyName,"translateZ(0px)")}}}var" k="i.textureId;if(k){var" b="gShowController.textureManager;var" t;var="" e;if(i.hascontentsanimation){var="" x="0,A=N.length;x<A;x++){if(N[x].property==="contents"){k=N[x].to.texture;E=N[x].from.texture;break}}}var" t="this.cloneNode(b.getTextureObject(this.sceneIndex,k),n);T.setAttribute("id",k);if(browserPrefix==="webkit"&&i.isTransition==null){setElementProperty(T,kTransformPropertyName,"translateZ(0px)")}if(a===0&&o===0&&s===1&&l===1){this.setStyle(T,"0px","0px",v+"px",g+"px",kPositionAbsolutePropertyValue,null,null)}else{var" i="gShowController.script;var" w="(a+s)*F;var" "+w+"px,="" "+m+"px,="" "+b+"px)")}if(i.istransition){if(ischrome){if(this.enablecompositingusingbackface){if(!this.isgridtransition&&!this.ismosaictransition){setelementproperty(t,kbackfacevisibilitypropertyname,"hidden")}}else{if(this.isswooshtransition){setelementproperty(t,ktransformpropertyname,"translatez(0px)")}}}else{if(this.enablecompositingusingbackface){setelementproperty(t,kbackfacevisibilitypropertyname,"hidden")}else{setelementproperty(t,ktransformpropertyname,"translatez(0px)")}}}var="" l;var="" d;if(x.movie){var="" image;this.setstyle(d,"0px","0px",v+"px",g+"px",kpositionabsolutepropertyvalue,null,null);event.observe(d,"load",this.hideelement.bind(this,t));d.src="K}else{if(gShowController.movieCache==null){gShowController.movieCache={}}var" z="Y+"-video";i.hasMovie=true;i.movieId=Z;L=gShowController.movieCache[Z];if(L==null){var" z;for(var="" j="0,U=t.layers.length;j<U;j++){if(k===t.layers[j].textureId){if(j">0){z=t.layers[j-1].textureId}break}}var G={objectID:Y,movieId:Z,width:v,height:g,sceneIndex:this.sceneIndex,textureId:k,src:K,showControls:gShowController.isRecording===false?true:false,previousSiblingTextureId:z,movieDiv:r};L=new KPFMovie(G);gShowController.movieCache[Z]=L;L.observeEvents(T)}}}else{var W=gShowController.movieCache;if(W){var Z=Y+"-video";L=W[Z];if(!L){var H=t.objectID;if(H){Z=H+"-video";L=W[Z]}}}}if(i.hasContentsAnimation){T.setAttribute("preserveAspectRatio","none");var Q=document.createElement("div");Q.id=n+"-contents-to";this.setStyle(Q,T.style.top,T.style.left,T.style.width,T.style.height,kPositionAbsolutePropertyValue,null,null);Q.appendChild(T);P.appendChild(Q);setElementProperty(Q,"opacity",0);var q=gShowController.textureManager.getTextureObject(this.sceneIndex,E).cloneNode(true);q.setAttribute("id",E);this.setStyle(q,"0px","0px",v+"px",g+"px",kPositionAbsolutePropertyValue,null,null);setElementProperty(q,kBackfaceVisibilityPropertyName,"hidden");var $=document.createElement("div");$.id=n+"-contents-from";this.setStyle($,q.style.top,q.style.left,q.style.width,q.style.height,kPositionAbsolutePropertyValue,null,null);$.appendChild(q);P.appendChild($)}else{P.appendChild(T);if(D){P.appendChild(D)}}if(L){if(L.isFirstRendered){P.insertBefore(L.videoElement,T);L.isFirstRendered=false}else{P.appendChild(L.movieDiv);if(R){L.stopMovie();L.removeControls()}else{T.style.visibility="hidden";T.style.display="none";if(L.isPlaying&&!L.isEnded){L.startMovie()}}}}}else{if(i.initialState.backgroundColor){var J=i.initialState.backgroundColor;setElementProperty(P,"background-color","rgba("+parseInt(J[0]*255)+","+parseInt(J[1]*255)+","+parseInt(J[2]*255)+","+J[3]+")")}}for(var j=0,U=i.layers.length;j<u;j++){this.addnode(p,i,i.layers[j])}return r},clonenode:function(e,t){var="" i="e.cloneNode(true);if(i.nodeName.toLowerCase()==="svg"){var" n="i.getElementsByTagName("clipPath");if(n.length">0){var r={};for(var a=0,o=n.length;a<o;a++){var s="n[a];var" l="s.id;var" m="l+"-"+t;s.setAttributeNS(null,"id",m);r[l]=m}var" f="i.getElementsByTagName("g");for(var" a="0,o=f.length;a<o;a++){var" c="f[a];var" u="c.getAttributeNS(null,"clip-path");if(!u){continue}var" h="/\(#([^)]+)\)/;if(isIE||isEdge){h=/\(\"#([^)]+)\"\)/}var" d="h.exec(u);if(!d){continue}var" p="r[d[1]];c.setAttributeNS(null,"clip-path","url(#"+p+")")}}}if(isIE&&browserVersion">=10){var y=e.getElementsByTagName("feGaussianBlur");if(y){var v=i.getElementsByTagName("feGaussianBlur");for(var a=0,o=y.length;a<o;a++){v[a].setattribute("stddeviation",y[a].getattribute("stddeviation"))}}}return i},hideelement:function(e){e.style.visibility="hidden" },serializesvg:function(e){var="" t="e.getElementsByTagName("image");for(var" i="0,n=t.length;i<n;i++){var" r="t[i];var" a="document.createElement("a");a.href=r.getAttributeNS("http://www.w3.org/1999/xlink","href");var" o="window.location.protocol+"//"+a.host+a.pathname;r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o)}var" s="new" xmlserializer;var="" l="s.serializeToString(e);return" l},draw:function(e){this.setstyle(this.domnode,"0px","0px",this.nativewidth+"px",this.nativeheight+"px",kpositionabsolutepropertyvalue,this.opacity,this.visibility);if(browserprefix="=="webkit"){if(this.enableCompositingUsingBackface&&isChrome){setElementProperty(this.domNode,kBackfaceVisibilityPropertyName,"hidden")}else{setElementProperty(this.domNode,kTransformPropertyName,"translateZ(0px)")}}if(this.layer.sublayerTransform[11]!=0){setElementProperty(this.domNode,kPerspectivePropertyName,gShowController.stageManager.perspective+"px");setElementProperty(this.domNode,kTransformStylePropertyName,kTransformStylePreserve3DPropertyValue)}else{setElementProperty(this.domNode,kTransformStylePropertyName,kTransformStyleFlatPropertyValue)}for(var" t.duration},overallendtimeforlayer:function(e,t){if(e.cssanimation){if(e.cssanimation.overallendtime="">t.duration){t.duration=e.cssAnimation.overallEndTime}}for(var i=0,n=e.layers.length;i<n;i++){this.overallendtimeforlayer(e.layers[i],t)}},animate:function(e){if(this.animationsupported){if(e.kpflayer){if(e.movie){this.animateeffect(e,e.kpflayer,e.currentkpflayer?e.currentkpflayer:null,e.movie)}else{this.animateeffect(e,e.kpflayer,e.currentkpflayer?e.currentkpflayer:null)}}}},animateeffect:function(e,t,i,n){if(t.cssanimationrules.length>0){var r=i?"layer"+i.layerId:"layer"+t.layerId;var a=document.getElementById(r);if(a){this.applyCssAnimation(a,t,i)}else{if(e.currentKPFLayer){r="layer"+e.currentKPFLayer.layerId;if(e.currentKPFLayer.layers[0]){r="layer"+e.currentKPFLayer.layers[0].layerId}a=document.getElementById(r);if(a){this.applyCssAnimation(a,t,e.currentKPFLayer)}}}}else{if(t.hasMovie&&t.animationInfo.name==="renderMovie"){var o=gShowController.movieCache[t.movieId];if(o){if(n.loopMode&&n.loopMode==="looping"){o.setLoop(true)}if(n.volume){o.setVolume(n.volume)}o.startMovie()}}if(i){var s=document.getElementById("layer"+i.layerId);var l=window.getComputedStyle(s,null);var m=l.getPropertyValue(kTransformPropertyName);var f=parseTransformMatrix(m);var c="matrix("+f[0]+","+f[1]+","+f[2]+","+f[3]+","+t.bounds.offset.pointX+","+t.bounds.offset.pointY+")";if(e.name==="apple:action-motion-path"){setElementProperty(s,kTransformPropertyName,c)}}}for(var u=0,h=t.layers.length;u<h;u++){this.animateeffect(e,t.layers[u],i?i.layers[u]:null,n)}},applycssanimation:function(e,t,i){var n="t.cssAnimation;var" r="t.cssAnimationRules;var" a="t.cssAnimation.overallEndTime;if(t.hasMovie){if(t.animationInfo.type==="buildOut"){this.stopMovie(document.getElementById(t.movieId))}}if(isChrome&&t.animationInfo.name==="apple:doorway"){if(t.layers.length===0&&t.contentsRect.x===0&&t.contentsRect.y===0&&t.contentsRect.width===1&&t.contentsRect.height===1){e.style.visibility="hidden"}}for(var" o="" in="" n.keyanimations){if(o!="bounds" ){continue}var="" s="n.keyAnimations[o];var" l="document.styleSheets[1].cssRules;for(var" m="0,f=l.length;m<f;m++){var" c="l[m];var" u="e.id+"-"+o;if(c.name===u){while(c.cssRules.length">0){if(isIE){for(var h=0,d=c.cssRules.length;h<d;h++){c.deleterule(h)}}else{c.deleterule(c.cssrules[0].keytext)}}for(var h="0,p=s.keyframes.length;h<p;h++){var" y="s.keyframes[h];if(o==="bounds"){var" v,g,p,k;if(y.keyframe="=0){v=y.value.width;g=y.value.height;c.appendRule("0%" {"+ktransformpropertyname+":="" scalex(1)="" scaley(1);="" "+kanimationtimingfunctionpropertyname+":="" "+y.timingfunction+";}")}else{p="y.value.width;k=y.value.height;c.appendRule(y.keyframe+"%" scalex("+p="" v+")="" scaley("+k="" g+");="" "+y.timingfunction+";}")}}}}}}if(t.initialstate.rotation!="=0||t.initialState.scale!==1){var" b="document.getElementById(e.id);var" t="window.getComputedStyle(b,null);var" e="T.getPropertyValue(kTransformPropertyName);var" n="parseTransformMatrix(E);var" x="matrix(1,0,0,1," +n[4]+","+n[5]+")";setelementproperty(b,ktransformpropertyname,x);var="" a="document.getElementById(e.id+"-"+escapeTextureId("transform.rotation.z"));if(A){setElementProperty(A,kTransformPropertyName,"rotateZ("+t.initialState.rotation+"rad)")}var" i="document.getElementById(e.id+"-"+escapeTextureId("transform.scale.x"));if(I){setElementProperty(I,kTransformPropertyName,"scaleX("+t.initialState.scale+")")}var" f="document.getElementById(e.id+"-"+escapeTextureId("transform.scale.y"));if(F){setElementProperty(F,kTransformPropertyName,"scaleY("+t.initialState.scale+")")}}for(var" o="" in="" n.keyanimations){var="" s="n.keyAnimations[o];var" c="s.keyActions;var" w="s.keyframes[s.keyframes.length-1];var" m="this.cssPropertyNameForAction(o);var" u="" ;var="" ;if(o="=="isPlaying"){continue}if(i&&t.animationInfo.type==="actionBuild"&&kActionBuildKeyAnimations[t.animationInfo.name].indexOf(o)===-1){continue}if(o==="doubleSided"){var" r="document.getElementById(e.id+"-"+escapeTextureId(o));if(R){setElementProperty(R,M,B)}continue}switch(o){case"opacity":u=e.id+"-opacity";Y=u;if(i){if(document.getElementById(u)==null){u=e.id}Y="layer"+t.layerId+"-opacity"}else{setElementProperty(e,"opacity",1)}break;case"hidden":M="opacity";if(B==="hidden"){B=0}else{e.style.visibility="visible";B=1}u=e.id;Y=u+"-hidden";if(i){Y="layer"+t.layerId+"-hidden"}break;case"bounds":u=e.id+"-bounds";Y=u;if(i){Y="layer"+t.layerId+"-bounds"}var" v,g,l,d;var="" k="s.keyframes[0];var" scaley("+o.value.height="" k.value.height+")";break;default:u="e.id+"-"+escapeTextureId(o);Y=u;if(i){Y="layer"+t.layerId+"-"+escapeTextureId(o)}break}if(o==="contents"){var" v="e.id+"-contents-from";var" z="e.id+"-contents-to";var" j="Z;if(i){z="layer"+t.layerId+"-contents-from";j="layer"+t.layerId+"-contents-to"}var" g="document.getElementById(Z);setElementProperty(U,"opacity",0);setElementProperty(U,kAnimationNamePropertyName,z);setElementProperty(U,kAnimationDurationPropertyName,X);setElementProperty(G,"opacity",1);setElementProperty(G,kAnimationNamePropertyName,j);setElementProperty(G,kAnimationDurationPropertyName,X);continue}var" translatey("+h.y+"px)"}else{if(o="=="anchorPointZ"){if(Prototype.Browser.Gecko||navigator.userAgent.lastIndexOf("Chrome/")">0){M=kTransformPropertyName;B="translateZ("+-t.transformOriginZValue+"px)"}else{M=kTransformPropertyName;B="translateZ("+t.transformOriginZValue+"px)"}}}if(o!=="hidden"){setElementProperty(W,M,B)}setElementProperty(W,kAnimationFillModePropertyName,S.fillMode==="removed"?"none":S.fillMode);setElementProperty(W,kAnimationNamePropertyName,Y);setElementProperty(W,kAnimationDurationPropertyName,X)}}},cssPropertyValueForActionValue:function(e,t){switch(e){case"hidden":if(t.scalar===true){return"hidden"}else{return"visible"}case"anchorPoint":return t.pointX+"% "+t.pointY+"%";case"anchorPointZ":return t.scalar;case"position":return"translate("+t.pointX+"px,"+t.pointY+"px)";case"zPosition":return"translateZ("+t.scalar+"px)";case"translationEmphasis":return"translateX("+t.translationEmphasis[0]+"px) translateY("+t.translationEmphasis[1]+"px) translateZ("+t.translationEmphasis[2]+")";case"rotationEmphasis":return"rotateZ("+t.rotationEmphasis[6]+"rad)";case"scaleEmphasis":return"scale3d("+ensureScaleFactorNotZero(t.scaleEmphasis[3])+","+ensureScaleFactorNotZero(t.scaleEmphasis[4])+","+ensureScaleFactorNotZero(t.scaleEmphasis[5])+")";case"transform.scale":case"transform.scale.xy":return"scale("+ensureScaleFactorNotZero(t.scalar)+")";case"transform.scale.x":return"scaleX("+ensureScaleFactorNotZero(t.scalar)+")";case"transform.scale.y":return"scaleY("+ensureScaleFactorNotZero(t.scalar)+")";case"transform.rotation.x":return"rotateX("+t.scalar+"rad)";case"transform.rotation.y":return"rotateY("+t.scalar+"rad)";case"transform.rotation.z":case"transform.rotation":return"rotateZ("+t.scalar+"rad)";case"transform.translation":return"translateX("+t.pointX+"px) translateY("+t.pointY+"px)";case"transform.translation.x":return"translateX("+t.scalar+"px)";case"transform.translation.y":return"translateY("+t.scalar+"px)";case"transform.translation.z":return"translateZ("+t.scalar+"px)";case"isPlaying":case"opacity":case"opacityMultiplier":return t.scalar+"";case"transform":return"matrix3d("+t.transform+")";case"doubleSided":if(t.scalar===false){return"hidden"}else{return"visible"}default:return"some value"}},cssPropertyNameForAction:function(e){switch(e){case"hidden":return kVisibilityPropertyName;case"anchorPoint":return kTransformOriginPropertyName;case"anchorPointZ":return kTransformOriginZPropertyName;case"opacityMultiplier":return kOpacityPropertyName;case"translationEmphasis":case"rotationEmphasis":case"scaleEmphasis":case"position":case"zPosition":case"transform":case"transform.scale":case"transform.scale.xy":case"transform.scale.x":case"transform.scale.y":case"transform.rotation.x":case"transform.rotation.y":case"transform.rotation.z":case"transform.rotation":case"transform.translation":case"transform.translation.x":case"transform.translation.y":case"transform.translation.z":case"bounds":return kTransformPropertyName;case"doubleSided":return kBackfaceVisibilityPropertyName;case"contents":return kBackgroundImagePropertyName;default:return e}},hideMoviePoster:function(e){e.style.visibility="hidden"},handleMovieDidStart:function(e,t){t.style.visibility="visible";setTimeout(this.hideMoviePoster.bind(this,e),120)},handleMovieDidEnd:function(e,t){if(!t.loop){t.isEnded=true}},startMovie:function(e){if(e){e.play();e.isPlaying=true}},stopMovie:function(e){if(e){e.pause()}}});var KPFLayer=Class.create({initialize:function(e,t,i){this.animationInfo=t;this.layerId=kpfLayerCounter;kpfLayerCounter=kpfLayerCounter+1;this.objectID=e.objectID!=null?e.objectID:null;this.textureId=e.texture?e.texture:null;this.animations=e.animations;this.initialState=e.initialState;this.cssAnimationRules=[];this.layers=[];this.affineTransform=this.initialState.affineTransform;this.position=this.initialState.position;this.textureTransform="";if(this.initialState.transform!=null&&this.initialState.transform!=undefined){this.textureTransform="matrix3D("+this.initialState.transform+")"}else{this.textureTransform="matrix("+this.affineTransform+")"}this.anchorPoint=this.initialState.anchorPoint;if(i==null){i={pointX:0,pointY:0}}var n=this.position.pointX-this.initialState.width/2-(this.anchorPoint.pointX-.5)*this.initialState.width;var r=this.position.pointY-this.initialState.height/2-(this.anchorPoint.pointY-.5)*this.initialState.height;n=Math.round(n*1e6)/1e6;r=Math.round(r*1e6)/1e6;this.bounds={width:this.initialState.width,height:this.initialState.height,origin:{pointX:this.affineTransform[4],pointY:this.affineTransform[5]},offset:{pointX:n,pointY:r},canvasOffset:{pointX:n+i.pointX,pointY:r+i.pointY}};this.sublayerTransform=this.initialState.sublayerTransform;this.contentsRect=this.initialState.contentsRect;this.hidden=this.initialState.hidden;this.opacity=this.initialState.opacity;this.visibility=this.hidden===true?"hidden":"visible";this.addSublayer(e.layers,t,this.bounds.offset);if(t.animationSupported){this.initLayerAnimations()}},destroy:function(){this.initialState=null;this.cssAnimationRules=null;this.affineTransform=null;this.textureTransform=null;this.anchorPoint=null;this.anchorPointZ=null;this.bounds=null;this.contentsRect=null;this.hidden=null;this.opacity=null},addSublayer:function(e,t,i){for(var n=0,r=e.length;n<r;n++){var a="new" kpflayer(e[n],t,i);this.layers.push(a)}},initlayeranimations:function(){var="" e="false;var" t="false;var" i="false;var" n="false;var" r="false;var" o="false;var" s="false;var" l="false;var" m="false;var" f="false;var" c="false;var" u="false;var" h="false;var" d="false;var" p="false;var" y="false;var" v="[];var" g="false;if(this.animationInfo.type==="actionBuild"){this.isActionBuild=true}else{if(this.animationInfo.type==="buildIn"){this.isBuildIn=true}else{if(this.animationInfo.type==="buildOut"){this.isBuildOut=true}else{if(this.animationInfo.type==="transition"){this.isTransition=true;if(this.animationInfo.name==="apple:magic-move-implied-motion-path"){this.isMagicMove=true}else{if(this.animationInfo.name==="apple:ca-isometric"){g=true}}}}}}if(this.animations.length">0){this.cssAnimation=new KPFCssAnimation(this.animations,this)}if(this.cssAnimation){this.divNames=[];var P={isPlaying:0,opacityMultiplier:1,hidden:2};for(var k in this.cssAnimation.keyAnimations){if(!P.hasOwnProperty(k)){if(k=="opacity"){t=true;if(this.isActionBuild){for(var b=0,T=this.layers.length;b<t;b++){if(this.layers[b].animations.length===0){if(!this.layers[b].divnames){this.layers[b].divnames=[]}this.layers[b].divnames.push("opacity");this.layers[b].divnames.push("position");this.layers[b].divnames.push("transform.rotation.z"); this.layers[b].divnames.push("transform.scale.x");this.layers[b].divnames.push("transform.scale.y")}}}}else{if(k="=="anchorPoint"){i=true}else{if(k==="anchorPointZ"){n=true}else{if(!g&&k==="transform.translation.x"){r=true}else{if(!g&&k==="transform.translation.y"){a=true}else{if(!g&&k==="transform.translation.z"){o=true}else{if(!g&&k==="transform.translation"){s=true}else{if(!g&&k==="transform.rotation.x"){l=true}else{if(!g&&k==="transform.rotation.y"){m=true}else{if(!g&&k==="transform.rotation.z"){f=true}else{if(!g&&k==="transform.rotation"){c=true}else{if(k==="transform.scale.x"){u=true}else{if(k==="transform.scale.y"){h=true}else{if(k==="transform.scale.xy"){d=true}else{if(k==="transform.scale"){p=true}else{if(k==="transform"){y=true}else{if(k==="doubleSided"){e=true}else{if(k==="contents"){this.hasContentsAnimation=true}else{if(k==="bounds"){this.hasBoundsAnimation=true}else{if(k==="position"){this.hasPosition=true}else{v.push(k)}}}}}}}}}}}}}}}}}}}}}}if(t||this.isActionBuild){this.divNames.push("opacity")}if(y){this.divNames.push("transform")}if(this.hasPosition||this.isActionBuild){this.divNames.push("position")}if(i){this.divNames.push("anchorPoint")}if(n){this.divNames.push("anchorPointZ")}for(var" b="0,T=v.length;b<T;b++){this.divNames.push(v[b])}if(r){this.divNames.push("transform.translation.x")}if(a){this.divNames.push("transform.translation.y")}if(s){this.divNames.push("transform.translation")}if(o){this.divNames.push("transform.translation.z")}if(l){this.divNames.push("transform.rotation.x")}if(m){this.divNames.push("transform.rotation.y")}if(f){this.divNames.push("transform.rotation.z")}if((this.initialState.rotation!==0||this.isActionBuild)&&this.divNames.indexOf("transform.rotation.z")===-1){this.divNames.push("transform.rotation.z")}if(c){this.divNames.push("transform.rotation")}if(u){this.divNames.push("transform.scale.x")}if(h){this.divNames.push("transform.scale.y")}if(this.initialState.scale!==1||this.isActionBuild){if(this.divNames.indexOf("transform.scale.x")===-1){this.divNames.push("transform.scale.x")}if(this.divNames.indexOf("transform.scale.y")===-1){this.divNames.push("transform.scale.y")}}if(d){this.divNames.push("transform.scale.xy")}if(p){this.divNames.push("transform.scale")}if(this.hasBoundsAnimation){this.divNames.push("bounds")}if(e){this.divNames.push("doubleSided")}}}});var" kpfcssanimation="Class.create({initialize:function(e,t){this.kDelta=1e-4;this.kRoundingFactor=1e4;this.animations=[];this.keyAnimations={};for(var" i="0,n=e.length;i<n;i++){var" r="e[i];var" a="r.beginTime;var" o="r.duration;var" s="r.timingFunction?r.timingFunction:"linear";var" l;var="" m;var="" f;var="" c;var="" u;var="" h="a+o;this.overallEndTime=0;if(h">this.overallEndTime){this.overallEndTime=h}if(s=="custom"){l=r.timingControlPoint1x;m=r.timingControlPoint1y;f=r.timingControlPoint2x;c=r.timingControlPoint2y}if(r.animations!=null&&r.animations.length>0){var d=r.animations;var p=a;if(d[0].property==null){p=d[0].beginTime;d=d[0].animations}for(var y=0,v=d.length;y<v;y++){var g="d[y];var" p="g.property;var" k="this.keyAnimations[P];if(k==null){k={groupBeginTime:p,earliestBeginTime:p+g.beginTime,latestEndTime:-1,keyActions:[]};this.keyAnimations[P]=k}if(p+g.beginTime+g.duration">k.latestEndTime){k.latestEndTime=p+g.beginTime+g.duration}if(g.path){var b=r.path.length;for(var T=0;i<b-1;t++){var e="r.path[T];var" n="r.path[T+1];var" x="E.points[0];var" a="N.points[0];var" i="{pointX:x[0],pointY:x[1]};var" f="{pointX:A[0],pointY:A[1]};switch(E.type){case"MoveToPoint":case"AddLine":case"AddCurve":case"AddQuadCurve":u={property:"position",from:I,to:F,fillMode:"forwards",beginTime:p+g.beginTime+T/(b-1)*g.duration,duration:1/(b-1)*g.duration,timingFunction:"linear",groupTimingFunction:s,groupBeginTime:a,groupDuration:o,groupTimingControlPoint1x:l,groupTimingControlPoint1y:m,groupTimingControlPoint2x:f,groupTimingControlPoint2y:c};break}this.addAction(u,g)}}else{if(g.keyTimes){var" c="g.keyTimes.length;for(var" t="0;T<C-1;T++){var" s="g.keyTimes[T];var" w="g.keyTimes[T+1];u={property:g.property,from:g.values[T],to:g.values[T+1],fillMode:g.fillMode,beginTime:p+g.beginTime+S/1*g.duration,duration:(w-S)*g.duration,timingFunction:g.timingFunctions?g.timingFunctions[T]:"linear",groupTimingFunction:s,groupBeginTime:a,groupDuration:o,groupTimingControlPoint1x:l,groupTimingControlPoint1y:m,groupTimingControlPoint2x:f,groupTimingControlPoint2y:c};this.addAction(u,g)}}else{u={property:g.property,from:g.from,to:g.to,fillMode:g.fillMode,beginTime:p+g.beginTime,duration:g.duration,timingFunction:g.timingFunction?g.timingFunction:"linear",groupTimingFunction:s,groupBeginTime:a,groupDuration:o,groupTimingControlPoint1x:l,groupTimingControlPoint1y:m,groupTimingControlPoint2x:f,groupTimingControlPoint2y:c};this.addAction(u,g)}}}}else{var" p="r.property;var" k="this.keyAnimations[P];if(k==null){k={groupBeginTime:0,earliestBeginTime:r.beginTime,latestEndTime:-1,keyActions:[]};this.keyAnimations[P]=k}if(r.beginTime+r.duration">k.latestEndTime){k.latestEndTime=r.beginTime+r.duration}if(r.path){var b=r.path.length;for(var T=0;T<b-1;t++){var e="r.path[T];var" n="r.path[T+1];var" x="E.points[0];var" a="N.points[0];var" i="{pointX:x[0],pointY:x[1]};var" f="{pointX:A[0],pointY:A[1]};switch(E.type){case"MoveToPoint":case"AddLine":case"AddCurve":case"AddQuadCurve":u={property:"position",from:I,to:F,fillMode:"forwards",beginTime:a+T/(b-1)*o,duration:1/(b-1)*o,timingFunction:"linear"};break}this.addAction(u,r)}}else{if(r.keyTimes){var" c="r.keyTimes.length;for(var" t="0;T<C-1;T++){var" s="r.keyTimes[T];var" w="r.keyTimes[T+1];u={property:r.property,from:r.values[T],to:r.values[T+1],fillMode:r.fillMode,beginTime:S/1*o,duration:(w-S)*o,timingFunction:r.timingFunctions?r.timingFunctions[T]:"linear"};this.addAction(u,r)}}else{u={property:r.property,from:r.from,to:r.to,fillMode:r.fillMode,beginTime:a,duration:o,timingFunction:s?s:"linear"};this.addAction(u,r)}}}}this.createKeyActions();this.createAnimationRules(t);this.createAnimationRuleForKeyframes(t)},addAction:function(e,t){if(t.timingFunction==="custom"){e.timingControlPoint1x=t.timingControlPoint1x;e.timingControlPoint1y=t.timingControlPoint1y;e.timingControlPoint2x=t.timingControlPoint2x;e.timingControlPoint2y=t.timingControlPoint2y}else{if(e.timingFunction.timingFunction!=null){if(e.timingFunction.timingFunction==="custom"){e.timingControlPoint1x=e.timingFunction.timingControlPoint1x;e.timingControlPoint1y=e.timingFunction.timingControlPoint1y;e.timingControlPoint2x=e.timingFunction.timingControlPoint2x;e.timingControlPoint2y=e.timingFunction.timingControlPoint2y}e.timingFunction=e.timingFunction.timingFunction}}this.animations.push(e)},createKeyActions:function(){for(var" r="i.duration;var" o="i.property;var" l="s.keyActions;var" m="s.latestEndTime-s.earliestBeginTime;var">0){f=100*n/this.overallEndTime;c=100*a/this.overallEndTime}if(c>100){c=100}var u={startKeyframe:f,endKeyframe:c,from:i.from,to:i.to,timingFunction:i.timingFunction};if(i.fillMode){u.fillMode=i.fillMode}if(i.timingFunction=="custom"){u.timingControlPoint1x=i.timingControlPoint1x;u.timingControlPoint1y=i.timingControlPoint1y;u.timingControlPoint2x=i.timingControlPoint2x;u.timingControlPoint2y=i.timingControlPoint2y}l.push(u);l.sort(this.sortAction)}},sortAction:function(e,t){return e.startKeyframe-t.startKeyframe},roundNum:function(e){return Math.round(e*this.kRoundingFactor)/this.kRoundingFactor},createAnimationRules:function(e){var t=this.kDelta;for(var i in this.keyAnimations){if(i=="playing"){continue}var n=this.keyAnimations[i];var r=n.keyActions;var a=false;n.keyframes=[];var o=r[0];var s=this.roundNum(o.startKeyframe);var l=this.roundNum(100*n.groupBeginTime/this.overallEndTime);if(i=="anchorPoint"){var m={};m.x=o.to.pointX;m.y=o.to.pointY;var f={pointX:-(o.from.pointX-e.anchorPoint.pointX)*e.bounds.width,pointY:-(o.from.pointY-e.anchorPoint.pointY)*e.bounds.height};if(e.isMagicMove){var c=this.anchorPointOffset(e,{x:o.from.pointX,y:o.from.pointY});var u={pointX:c.x,pointY:c.y};var h=this.anchorPointOffset(e,{x:o.to.pointX,y:o.to.pointY});var d={pointX:h.x,pointY:h.y};if(u.pointX!==d.pointX||u.pointY!=d.pointY){f={pointX:d.pointX-u.pointX,pointY:d.pointY-u.pointY};e.magicMoveOffsetValue=f}}if(s!=0){var p={pointX:0,pointY:0};if(l>0){this.insertInitialKeyframes(n,l-t,"position",p)}if(s-l>t){if(o.fillMode==="both"||o.fillMode==="backwards"){p=f}n.keyframes.push({keyframe:l,keyName:"position",value:p,timingFunction:"linear"});n.keyframes.push({keyframe:s-t,keyName:"position",value:p,timingFunction:"linear"})}}n.keyframes.push({keyframe:s,keyName:"position",value:f,timingFunction:"linear"});n.keyframes.push({keyframe:100,keyName:"position",value:f,timingFunction:"linear"});e.transformOriginValue=m.x*100+"% "+m.y*100+"%";continue}if(i=="anchorPointZ"){a=true;if(s!=0){var p=this.createInitialKeyframeValue(e,i,o.from,true);n.keyframes.push({keyframe:0,keyName:"zPosition",value:p,timingFunction:"linear"});n.keyframes.push({keyframe:s-t,keyName:"zPosition",value:p,timingFunction:"linear"})}n.keyframes.push({keyframe:s,keyName:"zPosition",value:o.from,timingFunction:"linear"});n.keyframes.push({keyframe:100,keyName:"zPosition",value:o.to,timingFunction:"linear"});e.transformOriginZValue=o.to.scalar;continue}if(o==null){continue}var y=0;var v=null;var g=null;if(s!=0){if(i==="hidden"){g={scalar:e.hidden};this.insertInitialKeyframes(n,s-t,i,g)}else{if(i==="opacity"){if(o.fillMode==="both"||o.fillMode==="backwards"){g=o.from}else{g={scalar:e.opacity}}this.insertInitialKeyframes(n,s-t,i,g)}else{if(i==="position"){if(e.isBuildIn||e.isBuildOut){if(l>0&&o.fillMode!=="both"&&o.fillMode!=="backwards"){g={pointX:0,pointY:0}}else{g={pointX:this.roundNum(o.from.pointX-e.initialState.position.pointX),pointY:this.roundNum(o.from.pointY-e.initialState.position.pointY)}}}else{g={pointX:0,pointY:0}}this.insertInitialKeyframes(n,s-t,i,g)}else{g=this.createInitialKeyframeValue(e,i,o.from,a);if(l>0){this.insertInitialKeyframes(n,l-t,i,g)}if(s-l>t){if(o.fillMode==="both"||o.fillMode==="backwards"){g=o.from}if(i==="transform.translation"){g.pointX=this.roundNum(g.pointX);g.pointY=this.roundNum(g.pointY)}n.keyframes.push({keyframe:l,keyName:i,value:g,timingFunction:"linear"});n.keyframes.push({keyframe:s-t,keyName:i,value:g,timingFunction:"linear"})}}}}y=o.startKeyframe;v=g}for(var P=0,k=r.length;P<k;p++){o=r[p];if(i=="position"){g=e.initialstate.position;o.from={pointx:this.roundnum(o.from.pointx-g.pointx),pointy:this.roundnum(o.from.pointy-g.pointy)};o.to={pointx:this.roundnum(o.to.pointx-g.pointx),pointy:this.roundnum(o.to.pointy-g.pointy)}}if(math.abs(o.startkeyframe-y)>t){n.keyframes.push({keyframe:this.roundNum(o.startKeyframe)-t,keyName:i,value:v,timingFunction:"linear"})}if(i==="transform.translation"){o.from.pointX=this.roundNum(o.from.pointX);o.from.pointY=this.roundNum(o.from.pointY);o.to.pointX=this.roundNum(o.to.pointX);o.to.pointY=this.roundNum(o.to.pointY)}var b=this.createTimingFunctionForAction(o);n.keyframes.push({keyframe:this.roundNum(o.startKeyframe),keyName:i,value:o.from,timingFunction:b});n.keyframes.push({keyframe:this.roundNum(o.endKeyframe)-(o.endKeyframe==100?0:t),keyName:i,value:o.to,timingFunction:b});v=o.to;y=o.endKeyframe}if(y!=100&&i!="hidden"){n.keyframes.push({keyframe:this.roundNum(y),keyName:i,value:v,timingFunction:"linear"});n.keyframes.push({keyframe:100,keyName:i,value:v,timingFunction:"linear"})}}},insertInitialKeyframes:function(e,t,i,n){e.keyframes.push({keyframe:0,keyName:i,value:n,timingFunction:"linear"});e.keyframes.push({keyframe:t,keyName:i,value:n,timingFunction:"linear"})},anchorPointOffset:function(e,t){var i={};var n={};var r={};var a=e.bounds;i.x=a.width/2;i.y=a.height/2;n.x=t.x*a.width;n.y=t.y*a.height;r.x=i.x-n.x;r.y=i.y-n.y;return r},createInitialKeyframeValue:function(e,t,i,n){var r={};switch(t){case"anchorPoint":r.pointX=(e.anchorPoint.pointX-.5)*e.bounds.width;r.pointY=(e.anchorPoint.pointY-.5)*e.bounds.height;break;case"anchorPointZ":if(Prototype.Browser.Gecko||Prototype.Browser.IE||isChrome||isIE||isEdge){r.scalar=0}else{r.scalar=i.scalar+i.scalar}break;case"opacity":case"opacityMultiplier":r.scalar=e.opacity;break;case"hidden":r.scalar=e.hidden;break;case"position":r.pointX=e.affineTransform[4];r.pointY=e.affineTransform[5];break;case"zPosition":r.scalar=0;break;case"transform.scale":case"transform.scale.xy":case"transform.scale.x":case"transform.scale.y":r.scalar=e.initialState.scale;break;case"transform.rotation.z":r.scalar=e.initialState.rotation;case"transform":r.transform=i.transform;break;case"bounds":r.pointX=0;r.pointY=0;r.width=e.initialState.width;r.height=e.initialState.height;break;default:r.scalar=0;r.pointX=0;r.pointY=0;break}return r},createTimingFunctionForAction:function(e){var t="";var i=e.timingFunction;var n=e;if(typeof i==="object"){i=i.timingFunction;n=e.timingFunction}switch(i.toLowerCase()){case"easein":t="ease-in";break;case"easeout":t="ease-out";break;case"easeinout":case"easeineaseout":t="ease-in-out";break;case"custom":t="cubic-bezier("+n.timingControlPoint1x+","+n.timingControlPoint1y+","+n.timingControlPoint2x+","+n.timingControlPoint2y+")";break;case"linear":t="linear";break;default:t="linear";break}return t},createAnimationRuleForKeyframes:function(e){for(var t in this.keyAnimations){var i=this.keyAnimations[t];var n="layer"+e.layerId+"-"+escapeTextureId(t);var r;var a="";var o;if(t==="contents"){var s=this.roundNum(i.keyActions[0].startKeyframe);r=gShowController.animationManager.createAnimation(n+"-from");var l="0% {opacity: 1; "+kAnimationTimingFunctionPropertyName+": linear;}";var m="49.999% {opacity: 1; "+kAnimationTimingFunctionPropertyName+": linear;}";var f="50% {opacity: 0; "+kAnimationTimingFunctionPropertyName+": linear;}";var c="100% {opacity: 0; "+kAnimationTimingFunctionPropertyName+": linear;}";if(s!==0){m=(100-s)/2+s-this.kDelta-this.kDelta+"% {opacity: 1; "+kAnimationTimingFunctionPropertyName+": linear;}";f=(100-s)/2+s+"% {opacity: 0; "+kAnimationTimingFunctionPropertyName+": linear;}"}r.appendRule(l);r.appendRule(m);r.appendRule(f);r.appendRule(c);r=gShowController.animationManager.createAnimation(n+"-to");l="0% {opacity: 0; "+kAnimationTimingFunctionPropertyName+": linear;}";m="49.999% {opacity: 0; "+kAnimationTimingFunctionPropertyName+": linear;}";f="50% {opacity: 1; "+kAnimationTimingFunctionPropertyName+": linear;}";c="100% {opacity: 1; "+kAnimationTimingFunctionPropertyName+": linear;}";if(s!==0){m=(100-s)/2+s-this.kDelta-this.kDelta+"% {opacity: 0; "+kAnimationTimingFunctionPropertyName+": linear;}";f=(100-s)/2+s+"% {opacity: 1; "+kAnimationTimingFunctionPropertyName+": linear;}"}r.appendRule(l);r.appendRule(m);r.appendRule(f);r.appendRule(c);continue}if(!isIE){r=gShowController.animationManager.createAnimation(n);for(var u=0,h=i.keyframes.length;u<h;u++){o=i.keyframes[u];a=this.createanimationruleforkeyframe(t,o,e)+" ";r.appendrule(a)}e.cssanimationrules.push(n)}else{if(browserversion="">=10){for(var u=0,h=i.keyframes.length;u<h;u++){o=i.keyframes[u];a+=this.createanimationruleforkeyframe(t,o,e)+" "}gshowcontroller.animationmanager.stylesheet.insertrule(kkeyframespropertyname+"="" "+n+"="" {"+a+"}",0);e.cssanimationrules.push(n)}}}},createanimationruleforkeyframe:function(e,t,i){var="" n="t.keyframe;var" r="t.keyName;var" a="t.value;var" o="t.timingFunction;var" s;var="" l="i.transformOriginValue;var" m="i.transformOriginZValue;var" f="" ;if(l){f="kTransformOriginPropertyName+":" "+l+";"}if(r="="hidden"){var" c="{scalar:-1};if(a.scalar==false){c.scalar=1}else{c.scalar=0}r="opacity";s=this.cssPropertyValueForActionValue(e,r,c)}else{s=this.cssPropertyValueForActionValue(e,r,a)}var" u;u="this.cssPropertyNameForAction(r)+":" "+s+";="" "+(n<100?kanimationtimingfunctionpropertyname+":="" "+o+";":"");var="" h="n+"%" {"+f+u+"}";return="" h},csspropertyvalueforactionvalue:function(e,t,i){switch(t){case"hidden":if(i.scalar="=true){return"hidden"}else{return"visible"}case"anchorPoint":return" i.pointx+"%="" "+i.pointy+"%";case"anchorpointz":return="" i.scalar;case"position":return"translate("+i.pointx+"px,"+i.pointy+"px)";case"zposition":if(e="="anchorPointZ"&&(Prototype.Browser.Gecko||navigator.userAgent.lastIndexOf("Chrome/")">0)){return"translateZ("+-i.scalar+"px)"}else{return"translateZ("+i.scalar+"px)"}case"translationEmphasis":return"translateX("+i.translationEmphasis[0]+"px) translateY("+i.translationEmphasis[1]+"px) translateZ("+i.translationEmphasis[2]+")";case"rotationEmphasis":return"rotateZ("+i.rotationEmphasis[6]+"rad)";case"scaleEmphasis":return"scale3d("+ensureScaleFactorNotZero(i.scaleEmphasis[3])+","+ensureScaleFactorNotZero(i.scaleEmphasis[4])+","+ensureScaleFactorNotZero(i.scaleEmphasis[5])+")";case"transform.scale":case"transform.scale.xy":return"scale("+ensureScaleFactorNotZero(i.scalar)+")";case"transform.scale.x":return"scaleX("+ensureScaleFactorNotZero(i.scalar)+")";case"transform.scale.y":return"scaleY("+ensureScaleFactorNotZero(i.scalar)+")";case"transform.rotation.x":return"rotateX("+i.scalar+"rad)";case"transform.rotation.y":return"rotateY("+i.scalar+"rad)";case"transform.rotation.z":case"transform.rotation":return"rotateZ("+i.scalar+"rad)";case"transform.translation":return"translateX("+i.pointX+"px) translateY("+i.pointY+"px)";case"transform.translation.x":return"translateX("+i.scalar+"px)";case"transform.translation.y":return"translateY("+i.scalar+"px)";case"transform.translation.z":return"translateZ("+i.scalar+"px)";case"isPlaying":case"opacity":case"opacityMultiplier":return i.scalar+"";case"transform":return"matrix3d("+i.transform+")";case"doubleSided":if(i.scalar==false){return"hidden"}else{return"visible"}case"contents":return i.texture;default:return"some value"}},cssPropertyNameForAction:function(e){switch(e){case"hidden":return kVisibilityPropertyName;case"anchorPoint":return kTransformOriginPropertyName;case"anchorPointZ":return kTransformOriginZPropertyName;case"opacityMultiplier":return kOpacityPropertyName;case"translationEmphasis":case"rotationEmphasis":case"scaleEmphasis":case"position":case"zPosition":case"transform":case"transform.scale":case"transform.scale.xy":case"transform.scale.x":case"transform.scale.y":case"transform.rotation.x":case"transform.rotation.y":case"transform.rotation.z":case"transform.rotation":case"transform.translation":case"transform.translation.x":case"transform.translation.y":case"transform.translation.z":case"bounds":return kTransformPropertyName;case"doubleSided":return kBackfaceVisibilityPropertyName;case"contents":return kBackgroundImagePropertyName;default:return e}}});</h;u++){o=i.keyframes[u];a+=this.createanimationruleforkeyframe(t,o,e)+"></h;u++){o=i.keyframes[u];a=this.createanimationruleforkeyframe(t,o,e)+"></k;p++){o=r[p];if(i=="position"){g=e.initialstate.position;o.from={pointx:this.roundnum(o.from.pointx-g.pointx),pointy:this.roundnum(o.from.pointy-g.pointy)};o.to={pointx:this.roundnum(o.to.pointx-g.pointx),pointy:this.roundnum(o.to.pointy-g.pointy)}}if(math.abs(o.startkeyframe-y)></b-1;t++){var></b-1;t++){var></v;y++){var></t;b++){if(this.layers[b].animations.length===0){if(!this.layers[b].divnames){this.layers[b].divnames=[]}this.layers[b].divnames.push("opacity");this.layers[b].divnames.push("position");this.layers[b].divnames.push("transform.rotation.z");></r;n++){var></d;h++){c.deleterule(h)}}else{c.deleterule(c.cssrules[0].keytext)}}for(var></h;u++){this.animateeffect(e,t.layers[u],i?i.layers[u]:null,n)}},applycssanimation:function(e,t,i){var></n;i++){this.overallendtimeforlayer(e.layers[i],t)}},animate:function(e){if(this.animationsupported){if(e.kpflayer){if(e.movie){this.animateeffect(e,e.kpflayer,e.currentkpflayer?e.currentkpflayer:null,e.movie)}else{this.animateeffect(e,e.kpflayer,e.currentkpflayer?e.currentkpflayer:null)}}}},animateeffect:function(e,t,i,n){if(t.cssanimationrules.length></o;a++){v[a].setattribute("stddeviation",y[a].getattribute("stddeviation"))}}}return></o;a++){var></u;j++){this.addnode(p,i,i.layers[j])}return></=0){setelementproperty(a,ktransformpropertyname,"translatez("+n.transformoriginzvalue+"px)")}}}}e.appendchild(a);return></t;e++){this.destroyeffect(this.effects[e])}this.type=null;this.name=null;this.begintime=null;this.duration=null;this.objectid=null;delete></r;n++){this.calculateoverallendtime(i,t.effects[n])}}});var></n;i++){this.animateeffect(t[i])}},overallendtime:function(){return></m;l++){t[a].effects.push(n.effects[l])}if(t[a].names==null){t[a].names=[]}t[a].names.push(n.name)}else{t.push(n)}}else{t.push(n)}}for(var></a;r++){this.addanimationstoidenticallayer(e.layers[r],t.layers[r])}}},processeffects:function(e){var></n;i++){t.animations.push(e.animations[i])}}if(e.layers&&e.layers.length></t;e++){this.effects[e].destroy()}delete>